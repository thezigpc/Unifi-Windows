(window.webpackJsonpunifiNetworkUi=window.webpackJsonpunifiNetworkUi||[]).push([[47],{1774:function(e,t,l){"use strict";var a=l(0),E=l.n(a),_=l(3),r=l(2),n=l(1780),T=l.n(n),c=l(1259),o=l(493),i=l(494);const R=Object(_.c)("span")`
  line-height: 1.5;
  margin-top: ${({theme:e})=>e.spacing["spacing-xxxxl"]};
`;t.a=({when:e,ignoredPaths:t=null,onLeave:l=null,onStay:_=null,leaveButtonText:n="SETTINGS_MODAL_UNSAVED_CHANGES_LEAVE",stayButtonText:A="SETTINGS_MODAL_UNSAVED_CHANGES_STAY",modalTitle:s="SETTINGS_MODAL_UNSAVED_CHANGES_TITLE",modalDescription:u="SETTINGS_MODAL_UNSAVED_CHANGES_CONTENT"})=>{const N=Object(a.useMemo)(()=>({overlay:{"--modal-z-index":2e3}}),[]),m=Object(i.a)(t),S=Object(a.useCallback)((e,t)=>t.pathname!==e.pathname,[]),p=Object(a.useCallback)(e=>(e={},t={})=>m(e,t)&&S(e,t),[m,S]);return!!e&&E.a.createElement(T.a,{when:p(t)},({onCancel:e,onConfirm:t})=>E.a.createElement(c.a,{actions:[{type:"button",text:E.a.createElement(r.c,{id:A}),onClick:()=>_?_(e):e()},{type:"button",text:E.a.createElement(r.c,{id:n}),onClick:()=>l?l(t):t(),variant:"primary"}],isOpen:!0,size:"small",style:N,parentSelector:o.b,title:E.a.createElement(r.c,{id:s}),onRequestClose:()=>_?_(e):e()},E.a.createElement(R,null,E.a.createElement(r.c,{id:u}))))}},2281:function(e,t,l){"use strict";l.r(t);var a,E,_=l(0),r=l.n(_),n=l(2),T=l(5),c=l(23),o=l(168),i=l(821),R=l(257),A=l(34),s=l(18),u=l(72),N=l(2429),m=l(251),S=l(28),p=l(40),L=l(16),d=l(101),I=l(19),O=l(2564);!function(e){e.AFTER="AFTER",e.BEFORE="BEFORE"}(a||(a={})),function(e){e.ADDRESS_PORT_GROUP="addressPortGroup",e.IP_ADDRESS="ipAddress",e.NETWORK="network"}(E||(E={}));const F=(e,t,l)=>[{label:l.formatMessage({id:"COMMON_ANY"}),value:""},...e.filter(({group_type:e})=>e===t).map(({_id:e,name:t,group_members:l})=>({label:t,value:e,members:l}))],G=(e,t)=>{const l=e["src"===t?"src_address":"dst_address"],a=e["src"===t?"src_firewallgroup_ids":"dst_firewallgroup_ids"],_=e["src"===t?"src_networkconf_id":"dst_networkconf_id"],r=e["src"===t?"src_networkconf_type":"dst_networkconf_type"];return(null==a?void 0:a.length)>0?E.ADDRESS_PORT_GROUP:l?E.IP_ADDRESS:_||r&&r!==R.FirewallRuleNetworkconfType.NETV4?E.NETWORK:E.ADDRESS_PORT_GROUP},M=e=>Object.values(R.FirewallRuleRulesetV6).includes(e.ruleset),w=(e,t,l)=>{const E={ruleset:R.FirewallRuleRulesetV4.WAN_IN,protocol:"all",protocol_v6:"all",...l},_=M(E)?E.protocol_v6:E.protocol,r=Number.isNaN(Number(_))?{firewallRuleProtocolNumber:0}:{firewallRuleProtocolNumber:Number(_),[M(E)?"protocol_v6":"protocol"]:"number"},n=((e,t,l)=>["dst","src"].reduce((a,E)=>{var _,r;const n=e["src"===E?"src_firewallgroup_ids":"dst_firewallgroup_ids"],T=e["src"===E?"src_networkconf_id":"dst_networkconf_id"];return{...a,["src"===E?"src_networkconf_id":"dst_networkconf_id"]:(null===(_=t.find(({_id:e})=>e===T))||void 0===_?void 0:_._id)||(null===(r=t[0])||void 0===r?void 0:r._id)||"",["src"===E?"firewallRuleSrcIpV4AddressGroup":"firewallRuleDstIpV4AddressGroup"]:n.find(e=>l.some(({_id:t,group_type:l})=>t===e&&l===i.FirewallGroupType.ADDRESS_GROUP))||"",["src"===E?"firewallRuleSrcIpV6AddressGroup":"firewallRuleDstIpV6AddressGroup"]:n.find(e=>l.some(({_id:t,group_type:l})=>t===e&&l===i.FirewallGroupType.IPV6_ADDRESS_GROUP))||"",["src"===E?"firewallRuleSrcPortGroup":"firewallRuleDstPortGroup"]:n.find(e=>l.some(({_id:t,group_type:l})=>t===e&&l===i.FirewallGroupType.PORT_GROUP))||"",["src"===E?"firewallRuleSrcType":"firewallRuleDstType"]:G(e,E)}},{}))({dst_firewallgroup_ids:[],dst_networkconf_id:"",src_firewallgroup_ids:[],src_networkconf_id:"",...l},e,t);return{action:R.FirewallRuleAction.ACCEPT,enabled:!0,firewallRuleApplied:Object(R.getRulePriority)({rule_index:2e3,...l})===R.FirewallRulePriority.HIGH?a.BEFORE:a.AFTER,dst_address:"",dst_firewallgroup_ids:[],dst_networkconf_type:R.FirewallRuleNetworkconfType.NETV4,icmp_typename:"",icmpv6_typename:"",ipsec:R.FirewallRuleIpsec.DONT_MATCH,logging:!1,name:"",protocol:"all",protocol_match_excepted:!1,protocol_v6:"all",ruleset:R.FirewallRuleRulesetV4.WAN_IN,src_firewallgroup_ids:[],src_address:"",src_mac_address:"",src_networkconf_type:R.FirewallRuleNetworkconfType.NETV4,state_established:!1,state_invalid:!1,state_new:!1,state_related:!1,...l,...r,...n}},b=[R.FirewallRuleAction.ACCEPT,R.FirewallRuleAction.REJECT,R.FirewallRuleAction.DROP].map(e=>({label:Object(O.c)(e),value:e})),D=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_VALUE_FIREWALL_RULE_APPLIED_BEFORE",value:a.BEFORE},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_VALUE_FIREWALL_RULE_APPLIED_AFTER",value:a.AFTER}],U=R.FIREWALL_RULE_ICMP_TYPENAMES.map(e=>({label:Object(O.d)(e),value:e})),g=R.FIREWALL_RULE_ICMPV6_TYPENAMES.map(e=>({label:Object(O.d)(e),value:e})),P=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_IPSEC_DONT_MATCH",value:R.FirewallRuleIpsec.DONT_MATCH},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_IPSEC_MATCH_IPSEC",value:R.FirewallRuleIpsec.MATCH_IPSEC},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_IPSEC_MATCH_NON_IPSEC",value:R.FirewallRuleIpsec.MATCH_NON_IPSEC}],f=[...R.FIREWALL_RULE_PROTOCOLS,"number"].map(e=>({label:Object(O.e)(e),value:e})),h=[...R.FIREWALL_RULE_PROTOCOLS_V6,"number"].map(e=>({label:Object(O.e)(e),value:e})),C=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_NETWORKCONF_TYPE_NETV4",value:R.FirewallRuleNetworkconfType.NETV4},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_NETWORKCONF_TYPE_ADDRV4",value:R.FirewallRuleNetworkconfType.ADDRV4}],W=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_TYPE_ADDRESS_PORT_GROUP",value:E.ADDRESS_PORT_GROUP},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_TYPE_NETWORK",value:E.NETWORK},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_TYPE_IP_ADDRESS",value:E.IP_ADDRESS}],y=[R.FirewallRuleRulesetV4.WAN_IN,R.FirewallRuleRulesetV4.WAN_OUT,R.FirewallRuleRulesetV4.WAN_LOCAL,R.FirewallRuleRulesetV4.LAN_IN,R.FirewallRuleRulesetV4.LAN_OUT,R.FirewallRuleRulesetV4.LAN_LOCAL,R.FirewallRuleRulesetV4.GUEST_IN,R.FirewallRuleRulesetV4.GUEST_OUT,R.FirewallRuleRulesetV4.GUEST_LOCAL,R.FirewallRuleRulesetV6.WANV6_IN,R.FirewallRuleRulesetV6.WANV6_OUT,R.FirewallRuleRulesetV6.WANV6_LOCAL,R.FirewallRuleRulesetV6.LANV6_IN,R.FirewallRuleRulesetV6.LANV6_OUT,R.FirewallRuleRulesetV6.LANV6_LOCAL,R.FirewallRuleRulesetV6.GUESTV6_IN,R.FirewallRuleRulesetV6.GUESTV6_OUT,R.FirewallRuleRulesetV6.GUESTV6_LOCAL].map(e=>({label:Object(O.f)(e),value:e})),v=I.a.object().shape({dst_address:I.a.string().when(["firewallRuleDstType","ruleset"],{is:(e,t)=>e===E.IP_ADDRESS&&!M({ruleset:t}),then:I.b}),dst_port:I.a.string().when(["firewallRuleDstType","protocol","ruleset"],{is:(e,t,l)=>e===E.IP_ADDRESS&&["tcp","tcp_udp","udp"].includes(t)&&!M({ruleset:l}),then:I.a.string().unifiPortRange(r.a.createElement(n.c,{id:"COMMON_VALIDATION_VALID_PORT_RANGE"}))}),firewallRuleDstType:I.a.string().oneOf(Object.values(E)),firewallRuleProtocolNumber:I.a.number().when(["protocol","protocol_v6","ruleset"],{is:(e,t,l)=>M({ruleset:l})?"number"===t:"number"===e,then:I.a.number().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_FIREWALL_RULE_PROTOCOL_NUMBER_LABEL").required().min(0).max(255)}),name:I.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_NAME_LABEL").required(),firewallRuleSrcType:I.a.string().oneOf(Object.values(E)),protocol:I.a.string().oneOf(R.FIREWALL_RULE_PROTOCOLS),protocol_v6:I.a.string().oneOf(R.FIREWALL_RULE_PROTOCOLS_V6),ruleset:I.a.string().oneOf([...Object.values(R.FirewallRuleRulesetV4),...Object.values(R.FirewallRuleRulesetV6)]),src_address:I.a.string().when(["firewallRuleSrcType","ruleset"],{is:(e,t)=>e===E.IP_ADDRESS&&!M({ruleset:t}),then:I.b}),src_mac_address:I.a.string().matches(d.q,{message:r.a.createElement(n.c,{id:"COMMON_VALIDATION_VALID_MAC"})}),src_port:I.a.string().when(["firewallRuleSrcType","protocol","ruleset"],{is:(e,t,l)=>e===E.IP_ADDRESS&&["tcp","tcp_udp","udp"].includes(t)&&!M({ruleset:l}),then:I.a.string().unifiPortRange(r.a.createElement(n.c,{id:"COMMON_VALIDATION_VALID_PORT_RANGE"}))})});var V=l(4),H=l(879),x=l(7),j=l(36),k=l(1763),B=l(1761),$=l(2379),Y=l(1762),K=l(2433),z=l(38);var q=()=>{const{setFieldValue:e,values:t}=Object(j.e)(),l=Object(_.useRef)(!0),a=M(t)?"all"===t.protocol_v6:"all"===t.protocol,E=M(t)?"icmpv6"===t.protocol_v6:"icmp"===t.protocol,T=M(t)?"number"===t.protocol_v6:"number"===t.protocol;return Object(_.useEffect)(()=>{if(!l.current)if(M(t)){const l=t.protocol,a=h.findIndex(({value:e})=>e===l);e("protocol_v6",h[-1!==a?a:0].value)}else{const l=t.protocol_v6,a=f.findIndex(({value:e})=>e===l);e("protocol",f[-1!==a?a:0].value)}l.current=!1},[t.ruleset]),r.a.createElement(k.a,null,r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:"ruleset",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_RULESET_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:"ruleset",options:y,searchable:!0,translateOptions:!0,type:"dropdown"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"input",htmlFor:"name",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_NAME_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:"name",placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_NAME_PLACEHOLDER"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"enabled",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_ENABLED_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{name:"enabled",type:"checkbox"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:"firewallRuleApplied",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_FIREWALL_RULE_APPLIED_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:"firewallRuleApplied",options:D,translateOptions:!0,type:"dropdown"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:"action",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_ACTION_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:"action",options:b,translateOptions:!0,type:"dropdown"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:M(t)?"protocol_v6":"protocol",label:r.a.createElement(n.c,{id:M(t)?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_PROTOCOL_V6_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_PROTOCOL_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:M(t)?"protocol_v6":"protocol",options:M(t)?h:f,searchable:!0,translateOptions:!0,type:"dropdown"}))),r.a.createElement(K.a,{in:E&&!t.protocol_match_excepted},r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:M(t)?"icmpv6_typename":"icmp_typename",label:r.a.createElement(n.c,{id:M(t)?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_ICMPV6_TYPENAME_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_ICMP_TYPENAME_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:M(t)?"icmpv6_typename":"icmp_typename",options:M(t)?g:U,searchable:!0,translateOptions:!0,type:"dropdown"})))),r.a.createElement(K.a,{in:T},r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"input",htmlFor:"firewallRuleProtocolNumber",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_FIREWALL_RULE_PROTOCOL_NUMBER_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:"firewallRuleProtocolNumber",placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_FIREWALL_RULE_PROTOCOL_NUMBER_PLACEHOLDER",type:"number"})))),r.a.createElement(K.a,{in:!a},r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"protocol_match_excepted",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_FIELD_PROTOCOL_MATCH_EXCEPTED_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{name:"protocol_match_excepted",type:"checkbox"})))))},J=l(3),X=l(279),Q=l(1259),Z=l(493),ee=l(2606),te=l(2541);const le=Object(J.c)(Q.a)`
  width: 378px !important;
`,ae=Object(J.c)("div")`
  padding: ${({theme:e})=>e.spacing["spacing-s"]} 0;
`;var Ee=({hideModal:e,handleGroupField:t,type:l,initialValues:a={}})=>{const E=Object(T.useDispatch)(),c=Object(T.useSelector)(s.x),o=Object(_.useCallback)((l,{setSubmitting:a})=>E(Object(i.saveFirewallGroup)({...l,group_members:(l.group_members||[]).filter(e=>!!e)})).then(e=>{t(e),E(Object(S.c)({icon:L.a.success,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_TOAST_SAVE_SUCCESS",values:{name:l.name}}))}).then(e).catch(e=>{E(Object(S.c)({errorMessage:e.msg,errorValues:e,icon:L.a.danger,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_TOAST_SAVE_FAILURE",values:{name:l.name}})),a(!1)}),[E,e,t]);return r.a.createElement(j.c,{onSubmit:o,initialValues:{name:"",group_type:l,group_members:[""],...a},validationSchema:te.b},({handleSubmit:t,isSubmitting:l})=>r.a.createElement(le,{parentSelector:Z.b,isOpen:!0,title:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_TITLE_NEW"}),actions:[{text:r.a.createElement(n.c,{id:"COMMON_ACTION_CANCEL"}),type:"button",style:{width:123},onClick:e},{text:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_BUTTON_CREATE"}),type:"submit",variant:"primary",style:{width:175},disabled:c||l,loader:l?"spinner":null,onClick:()=>t()}]},r.a.createElement(ae,null,r.a.createElement(ee.a,{modalForm:!0}))))};const _e=Object(J.c)("li",{shouldForwardProp:e=>"isNewGroupItem"!==e})`
  ${({theme:e,isNewGroupItem:t})=>t&&`\n    color: ${e.motifPalette.link01};\n    :hover {\n      color: ${e.motifPalette.hoverLink01};\n    }\n  `}
`,re=(e,t)=>{const l=parseInt(t,10);return!(t!==l.toString()||!Number.isFinite(l))&&(2===e.length&&l>=parseInt(e[0],10)&&l<=parseInt(e[1],10))};function ne({id:e,onClick:t,isSelected:l,className:a,children:E,option:_}){const T=X.a===_.value;return r.a.createElement(_e,{id:e,onClick:t,className:a,"aria-selected":l,role:"option",isNewGroupItem:T},T?r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_BUTTON_CREATE"}):E||_.label)}var Te=({name:e,options:t,type:l})=>{const{setFieldValue:a}=Object(j.e)(),[E,n]=Object(_.useState)(!1),[T,c]=Object(_.useState)(""),o=Object(_.useCallback)((t,l)=>{X.a===l?n(!0):a(e,l)},[e,a]),R=Object(_.useCallback)((e,t)=>e.filter(({label:e,members:a=[]})=>e.toString().toLowerCase().includes(t.toLowerCase())||((e,t,l)=>e.some(e=>{if(e===t)return!0;switch(l){case i.FirewallGroupType.PORT_GROUP:return re(e.split("-"),t);case i.FirewallGroupType.ADDRESS_GROUP:return re(e.split("-").map(e=>e.replace(/\./g,"")),t.replace(/\./g,""));default:return!1}}))(a,t,l)),[l]),A=Object(_.useMemo)(()=>{let e=[d.s];return l===i.FirewallGroupType.ADDRESS_GROUP&&(e=[d.i,d.k]),l===i.FirewallGroupType.IPV6_ADDRESS_GROUP&&(e=[d.l,d.n]),e.some(e=>T.match(e))?{group_members:[T]}:{name:"",group_members:[""]}},[T,l]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(z.Field,{name:e,options:t,renderOption:ne,onChange:o,inputProps:{onBlur:e=>c(e.target.value)},customSearchFilter:R,type:"dropdown",searchable:!0,creatable:!0,full:!0}),E&&r.a.createElement(Ee,{hideModal:()=>n(!1),handleGroupField:({_id:t,group_type:E})=>{E===l&&a(e,t)},type:l,initialValues:A}))};var ce=Object(n.f)(({intl:e,src:t})=>{const l=t?"src_address":"dst_address",a=t?"firewallRuleSrcIpV4AddressGroup":"firewallRuleDstIpV4AddressGroup",c=t?"firewallRuleSrcIpV6AddressGroup":"firewallRuleDstIpV6AddressGroup",o=t?"src_networkconf_id":"dst_networkconf_id",R=t?"src_networkconf_type":"dst_networkconf_type",s=t?"firewallRuleSrcPortGroup":"firewallRuleDstPortGroup",u=t?"src_port":"dst_port",N=t?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_FIREWALL_RULE_SRC_TYPE_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_FIREWALL_RULE_DST_TYPE_LABEL",m=t?"firewallRuleSrcType":"firewallRuleDstType",{errors:S,values:p}=Object(j.e)(),L=Object(T.useSelector)(A.selectCorporateAndGuestNetworks),d=Object(T.useSelector)(i.selectFirewallGroups),I=Object(_.useMemo)(()=>F(d,i.FirewallGroupType.ADDRESS_GROUP,e),[d,e]),O=Object(_.useMemo)(()=>F(d,i.FirewallGroupType.IPV6_ADDRESS_GROUP,e),[d,e]),G=Object(_.useMemo)(()=>L.map(({_id:e,name:t})=>({label:t,value:e})),[L]),w=Object(_.useMemo)(()=>F(d,i.FirewallGroupType.PORT_GROUP,e),[d,e]);return r.a.createElement(k.a,{padding:"none"},M(p)?r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:c,label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_IPV6_ADDRESS_GROUP_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(Te,{name:c,options:O,type:i.FirewallGroupType.IPV6_ADDRESS_GROUP}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:s,label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_PORT_GROUP_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(Te,{name:s,options:w,type:i.FirewallGroupType.PORT_GROUP})))):r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:m,label:r.a.createElement(n.c,{id:N})}),r.a.createElement(Y.a,null,r.a.createElement(z.Field,{full:!0,name:m,options:W,translateOptions:!0,type:"dropdown"}))),r.a.createElement(K.a,{in:p[m]===E.ADDRESS_PORT_GROUP,wrap:!0,flexDirection:"column"},p[m]===E.ADDRESS_PORT_GROUP&&r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:a,label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_IPV4_ADDRESS_GROUP_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(Te,{name:a,options:I,type:i.FirewallGroupType.ADDRESS_GROUP}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:s,label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_PORT_GROUP_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(Te,{name:s,options:w,type:i.FirewallGroupType.PORT_GROUP}))))),r.a.createElement(K.a,{in:p[m]===E.NETWORK,wrap:!0,flexDirection:"column"},p[m]===E.NETWORK&&r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:o,label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_NETWORKCONF_ID"})}),r.a.createElement(Y.a,null,r.a.createElement(z.Field,{full:!0,name:o,options:G,type:"dropdown"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"dropdown",htmlFor:R,label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_NETWORKCONF_TYPE"})}),r.a.createElement(Y.a,null,r.a.createElement(z.Field,{full:!0,name:R,options:C,translateOptions:!0,type:"dropdown"}))))),r.a.createElement(K.a,{in:p[m]===E.IP_ADDRESS,wrap:!0,flexDirection:"column"},p[m]===E.IP_ADDRESS&&r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"input",htmlFor:l,label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_ADDRESS_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:l,placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_ADDRESS_PLACEHOLDER"}))),["tcp","tcp_udp","udp"].includes(p.protocol)&&r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"input",htmlFor:u,label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_PORT_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:u,placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_PORT_PLACEHOLDER"})))))),t&&r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"input",htmlFor:"src_mac_address",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_SRC_MAC_ADDRESS_LABEL"})}),r.a.createElement(Y.a,{column:!0},r.a.createElement(z.Field,{full:!0,name:"src_mac_address",placeholder:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_SRC_DST_FIELD_SRC_MAC_ADDRESS_PLACEHOLDER"}))))});var oe=()=>r.a.createElement(k.a,{padding:"none"},r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"logging",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_LOGGING_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(z.Field,{name:"logging",type:"checkbox"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"state_new",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_STATE_NEW_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(z.Field,{name:"state_new",type:"checkbox"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"state_established",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_STATE_ESTABLISHED_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(z.Field,{name:"state_established",type:"checkbox"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"state_invalid",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_STATE_INVALID_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(z.Field,{name:"state_invalid",type:"checkbox"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"state_related",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_STATE_RELATED_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(z.Field,{name:"state_related",type:"checkbox"}))),r.a.createElement(B.a,null,r.a.createElement($.a,{alignWith:"toggleSmall",htmlFor:"ipsec",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ADVANCED_FIELD_IPSEC_LABEL"})}),r.a.createElement(Y.a,null,r.a.createElement(z.Field,{full:!0,name:"ipsec",options:P,translateOptions:!0,type:"dropdown"}))));var ie=()=>{const e=Object(_.useMemo)(()=>[{id:"firewall-rule-source",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ACCORDION_SOURCE_LABEL"}),renderContent:()=>r.a.createElement(ce,{src:!0})},{id:"firewall-rule-destination",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ACCORDION_DESTINATION_LABEL"}),renderContent:()=>r.a.createElement(ce,{dst:!0})},{id:"firewall-rule-advanced",label:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_ACCORDION_ADVANCED_LABEL"}),renderContent:()=>r.a.createElement(oe,null)}],[]);return Object(p.g)([Object(i.fetchFirewallGroups)(void 0,{crudCacheStrategy:{type:x.a.CACHE}}),Object(R.fetchFirewallRules)(void 0,{crudCacheStrategy:{type:x.a.CACHE}}),Object(A.fetchNetworks)(void 0,{crudCacheStrategy:{type:x.a.CACHE}}),Object(V.fetchSiteGateway)()],r.a.createElement(r.a.Fragment,null,r.a.createElement(q,null),r.a.createElement(H.a,{items:e,multiOpen:!0})))};t.default=()=>{const e=Object(p.i)({openFirewall:!0}),{ruleId:t}=Object(c.m)(),l=Object(T.useDispatch)(),d=Object(T.useSelector)(R.selectAllFirewallRules),I=Object(T.useSelector)(A.selectCorporateAndGuestNetworks),O=Object(T.useSelector)(i.selectFirewallGroups),F=Object(T.useSelector)(R.selectFirewallRule)(t),G=Object(T.useSelector)(s.x),b=Object(T.useSelector)(u.m),D=Object(_.useMemo)(()=>w(I,O,F),[I,O,F]),U=Object(p.o)({component:r.a.createElement(n.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_TITLE_NEW"}),message:"firewall-rule"},"firewall-rule",(null==F?void 0:F._id)?null==F?void 0:F.name:void 0),g=Object(_.useCallback)((t,{setSubmitting:_})=>l(Object(R.saveFirewallRule)(((e,t,l,_)=>{const r=w([],[]),{firewallRuleApplied:n,firewallRuleDstIpV4AddressGroup:T,firewallRuleDstIpV6AddressGroup:c,firewallRuleDstPortGroup:o,firewallRuleDstType:i,firewallRuleProtocolNumber:A,firewallRuleSrcIpV4AddressGroup:s,firewallRuleSrcIpV6AddressGroup:u,firewallRuleSrcPortGroup:N,firewallRuleSrcType:m,...S}=e;S.dst_firewallgroup_ids=i===E.ADDRESS_PORT_GROUP?[].concat((M(e)?c:T)||[]).concat(o||[]):r.dst_firewallgroup_ids,S.src_firewallgroup_ids=m===E.ADDRESS_PORT_GROUP?[].concat((M(e)?u:s)||[]).concat(N||[]):r.src_firewallgroup_ids,M(e)?(delete S.dst_address,delete S.dst_networkconf_id,delete S.dst_networkconf_type,delete S.dst_port,delete S.icmp_typename,delete S.protocol,delete S.src_address,delete S.src_networkconf_id,delete S.src_networkconf_type,delete S.src_port,S.icmpv6_typename="icmpv6"!==e.protocol_v6||e.protocol_match_excepted?r.icmpv6_typename:e.icmpv6_typename,S.protocol_match_excepted="all"===e.protocol_v6?r.protocol_match_excepted:e.protocol_match_excepted,S.protocol_v6="number"===e.protocol_v6?Number(e.firewallRuleProtocolNumber):e.protocol_v6):(delete S.icmpv6_typename,delete S.protocol_v6,S.dst_address=i===E.IP_ADDRESS?e.dst_address:r.dst_address,S.dst_networkconf_id=i===E.NETWORK?e.dst_networkconf_id:r.dst_networkconf_id,S.dst_networkconf_type=i===E.NETWORK?e.dst_networkconf_type:r.dst_networkconf_type,S.dst_port=i===E.IP_ADDRESS?e.dst_port:r.dst_port,S.icmp_typename="icmp"!==e.protocol||e.protocol_match_excepted?r.icmp_typename:e.icmp_typename,S.protocol="number"===e.protocol?Number(e.firewallRuleProtocolNumber):e.protocol,S.protocol_match_excepted="all"===e.protocol?r.protocol_match_excepted:e.protocol_match_excepted,S.src_address=m===E.IP_ADDRESS?e.src_address:r.src_address,S.src_networkconf_id=m===E.NETWORK?e.src_networkconf_id:r.src_networkconf_id,S.src_networkconf_type=m===E.NETWORK?e.src_networkconf_type:r.src_networkconf_type,S.src_port=m===E.IP_ADDRESS&&["tcp","tcp_udp","udp"].includes(e.protocol)?e.src_port:r.src_port);const p=n===a.BEFORE?R.FirewallRulePriority.HIGH:R.FirewallRulePriority.LOW;let L=e.rule_index;if(!e._id||e.ruleset!==t.ruleset||Object(R.getRulePriority)(e)!==p){const t=l?"udm":"ugw",a=M(e)?"v6":"v4",[E,r]=R.FIREWALL_RULE_INDEX_SCOPE[t][a][p],n=_.filter(({rule_index:t,ruleset:l})=>l===e.ruleset&&Number(t)>=E&&Number(t)<=r).pop()||{rule_index:E-1};L=Number(n.rule_index)+1,L=String(Math.min(L,r))}return S.rule_index=L,S})(t,D,b,d))).then(()=>{l(Object(S.c)({icon:L.a.success,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_TOAST_SAVE_SUCCESS",values:{name:t.name}})),e()}).catch(e=>{l(Object(S.c)({errorMessage:e.msg,errorValues:e,icon:L.a.danger,message:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_FORM_TOAST_SAVE_FAILURE",values:{name:t.name}})),_(!1)}),[d,l,D,b,e]),P=Object(_.useCallback)(()=>l(Object(m.b)({name:D.name,onConfirm:()=>l(Object(R.removeFirewallRule)({id:D._id,name:D.name})).then(()=>{e()})})),[l,D,e]);return r.a.createElement(N.b,{goBack:e,initialValues:D,isView:G,showBack:!0,title:U,validationSchema:v,onEscClicked:e,onSubmit:g,footerActiveOverride:!!(null==D?void 0:D._id),customFooterButtons:e=>(null==D?void 0:D._id)&&r.a.createElement(o.a,{disabled:e,type:"button",variant:"tertiary",color:"danger",onClick:P},r.a.createElement(n.c,{id:"COMMON_ACTION_REMOVE"}))},r.a.createElement(ie,null))}},2429:function(e,t,l){"use strict";l.d(t,"b",(function(){return w})),l.d(t,"a",(function(){return L}));var a=l(0),E=l.n(a),_=l(3),r=l(2),n=l(36),T=l(2838),c=l(2760),o=l(1774),i=l(867),R=l(14),A=l(10),s=l(42);const u=Object(_.c)(R.g)`
  > * {
    /* Use margin on child rather than padding on self not to occupy space when no button is shown */
    margin-left: ${({theme:e})=>e.spacing["spacing-xxl"]};
    margin-right: ${({theme:e})=>e.spacing["spacing-xxl"]};
  }
`,N=Object(_.c)(R.g)`
  border-bottom: 1px solid ${({theme:e})=>e.motifPalette.ui03};
`,m=Object(_.c)("h1")`
  font-size: 16px;
  font-weight: normal;
`,S=Object(_.c)(R.c)`
  padding: ${({theme:e})=>e.spacing["spacing-s"]};
`,p=Object(_.c)(s.a)`
  color: ${({theme:e})=>e.motifPalette.text01} !important;
  font-size: 16px !important;
`;var L=({title:e,showBack:t,goBack:l,onEscClicked:a,hideClose:_,ignoredPaths:r})=>E.a.createElement(N,{flex:"none",height:"65px"},E.a.createElement(R.g,{alignItems:"center",flex:"1",justifyContent:"space-between"},E.a.createElement(u,{alignItems:"center",flex:"1",height:"100%"},t&&E.a.createElement(S,{legacy:!1,name:"backButton",type:"button",onClick:l},E.a.createElement(A.g,{size:"original"}))),E.a.createElement(m,null,E.a.createElement(p,{weight:"bold"},e.component)),E.a.createElement(u,{alignItems:"center",flex:"1",height:"100%",justifyContent:"flex-end"},!_&&E.a.createElement(S,{legacy:!1,name:"closeButton",type:"button",onClick:a},E.a.createElement(A.A,{size:"original"})))));const d=Object(_.c)(R.g)`
  width: 100%;
  max-width: ${i.a};
  margin: 0 auto;
  padding: ${({theme:e})=>e.spacing["spacing-xxxxl"]}
    ${({theme:e})=>2*parseInt(e.spacing["spacing-xxxxl"],10)}px;
`,I=Object(_.c)("form")`
  display: flex;
  flex: 1;
  overflow: hidden;
  width: 100%;
  height: 100%;
`,O=Object(_.c)(R.g)`
  @media (max-width: 1010px) {
    flex-direction: column;
  }
`,F=Object(_.c)(T.a)`
  transition: height 100ms ease, transform 100ms ease; /* TODO: Remove with next ui-components update (v25.1.1 +)  */
  > :first-child {
    max-width: ${i.a};
    padding-left: ${({theme:e})=>2*parseInt(e.spacing["spacing-xxxxl"],10)}px !important;
    padding-right: ${({theme:e})=>2*parseInt(e.spacing["spacing-xxxxl"],10)}px !important;
    position: relative;
    margin: 0 auto;
  }
`,G=Object(_.c)(R.h)`
  background: transparent;
  overflow: scroll !important;
  margin-right: -${({theme:e})=>e.scrollBarWidth}px;
`,M=Object(_.c)(R.k)`
  height: 100%;
  width: 100%;
`;var w=({children:e,disableUnsavedChangesModal:t,goBack:l,hideClose:a,isEdit:_,isView:T,showBack:i,title:A,unsavedChangesModalIgnoredPaths:s,onEscClicked:u,submitText:N="COMMON_ACTION_APPLY_CHANGES",footerActiveOverride:m=!1,customFooterButtons:S,hidddenHeader:p,className:w,...b})=>E.a.createElement(n.c,Object.assign({enableReinitialize:!0},b),({dirty:_,handleReset:n,handleSubmit:b,isSubmitting:D})=>E.a.createElement(I,{autoComplete:"off",onSubmit:b,className:w},E.a.createElement(M,{vertical:!0},!p&&E.a.createElement(L,{goBack:l,hideClose:a,showBack:i,title:A,onEscClicked:u,ignoredPaths:s}),E.a.createElement(G,{flex:"1"},E.a.createElement(d,{flex:"none",flexDirection:"column"},e)),!t&&!T&&E.a.createElement(o.a,{ignoredPaths:s,when:_&&!D}),(!T||m)&&E.a.createElement(F,{active:_||m},E.a.createElement(R.g,{justifyContent:S?"space-between":"flex-end",width:"100%",alignItems:"center"},S&&E.a.createElement(O,null,S(D)),!T&&E.a.createElement(R.g,null,E.a.createElement(c.a,{disabled:!_||D,type:"button",variant:"default",onClick:n},E.a.createElement(r.c,{id:"COMMON_ACTION_CANCEL"})),E.a.createElement(c.a,{disabled:!_||D,type:"submit",variant:"primary"},E.a.createElement(r.c,{id:N}))))))))},2433:function(e,t,l){"use strict";var a=l(0),E=l.n(a),_=l(2312),r=l(3);const n=(e,t)=>r.a`
  &-appear,
  &-enter {
    opacity: 0;
    display: flex !important;
    transform: translateY(-10px);
  }
  &-appear-active,
  &-enter-active {
    display: flex !important;
    ${e&&`flex-direction: ${e};`}
    ${t&&`padding: ${t};`}
    opacity: 1;
    transform: translateY(0px);
    transition: opacity 150ms ease-in-out, transform 300ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-appear-done,
  &-enter-done {
    display: flex !important;
    ${e&&`flex-direction: ${e};`}
    ${t&&`padding: ${t};`}
    opacity: 1;
  }
  &-exit {
    display: flex !important;
    opacity: 0;
    height: 0;
    box-sizing: border-box;
    margin: 10px 0 0 !important;
    & > * {
      display: none;
    }
  }
  &-exit-active {
    display: flex !important;
    margin: 0 !important;
    transition: margin 300ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }
  &-exit-done {
    display: none;
  }
`;t.a=E.a.memo(({timeout:e=300,in:t=!1,flexDirection:l,padding:r="0 0 32px",wrap:T=!1,children:c,...o})=>{const i=Object(a.useMemo)(()=>E.a.Children.map(c,(a,r)=>E.a.createElement(_.a,Object.assign({appear:t,in:t,timeout:e,classNames:n(l,void 0),mountOnEnter:!0},o),null===a?E.a.createElement("div",null):a)),[c,l,t,o,e]);return T?E.a.createElement(_.a,Object.assign({appear:t,in:t,timeout:e,classNames:n(l,r),mountOnEnter:!0},o),E.a.createElement("div",null,c)):E.a.createElement(E.a.Fragment,null,i)})},2541:function(e,t,l){"use strict";l.d(t,"a",(function(){return T})),l.d(t,"b",(function(){return c}));var a=l(0),E=l.n(a),_=l(2),r=l(821),n=l(19);const T=[{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_PORT_GROUP",value:r.FirewallGroupType.PORT_GROUP},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_ADDRESS_GROUP",value:r.FirewallGroupType.ADDRESS_GROUP},{label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_IPV6_ADDRESS_GROUP",value:r.FirewallGroupType.IPV6_ADDRESS_GROUP}],c=n.a.object({name:n.a.string().label("SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_NAME_LABEL").required(),group_type:n.a.string(),group_members:n.a.array().when("group_type",{is:r.FirewallGroupType.PORT_GROUP,then:n.a.array().min(1,E.a.createElement(_.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_PORT_MIN"})).of(n.a.string().unifiPortRange(E.a.createElement(_.c,{id:"COMMON_VALIDATION_VALID_PORT"}),!0))}).when("group_type",{is:r.FirewallGroupType.ADDRESS_GROUP,then:n.a.array().min(1,E.a.createElement(_.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_MIN"})).of(n.a.string().unifiIpv4Range(E.a.createElement(_.c,{id:"COMMON_VALIDATION_VALID_IP_SUBNET_RANGE",values:{name:E.a.createElement(_.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_LABEL"})}})))}).when("group_type",{is:r.FirewallGroupType.IPV6_ADDRESS_GROUP,then:n.a.array().min(1,E.a.createElement(_.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_MIN"})).of(n.a.string().unifiIpv6Range(E.a.createElement(_.c,{id:"COMMON_VALIDATION_VALID_IPV6"})))}).of(n.a.string().required(E.a.createElement(_.c,{id:"COMMON_VALIDATION_FIELD_REQUIRED"})))})},2564:function(e,t,l){"use strict";l.d(t,"e",(function(){return T})),l.d(t,"a",(function(){return c})),l.d(t,"b",(function(){return o})),l.d(t,"c",(function(){return i})),l.d(t,"d",(function(){return R})),l.d(t,"f",(function(){return A})),l.d(t,"g",(function(){return s}));var a=l(0),E=l.n(a),_=l(2),r=l(821),n=l(257);const T=e=>"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_PROTOCOL_"+e.replace(/[.-]/g,"_").toUpperCase(),c=e=>{const t=void 0!==e.protocol&&null!==e.protocol?e.protocol:e.protocol_v6,l=!Number.isNaN(Number(t));return e.protocol_match_excepted?E.a.createElement(_.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_TABLE_PROTOCOL_MATCH_EXCEPTED",values:{protocol:l?t:E.a.createElement(_.c,{id:T(t)})}}):l?String(t):E.a.createElement(_.c,{id:T(t)})},o=e=>{switch(e){case r.FirewallGroupType.ADDRESS_GROUP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_ADDRESS_GROUP";case r.FirewallGroupType.IPV6_ADDRESS_GROUP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_IPV6_ADDRESS_GROUP";case r.FirewallGroupType.PORT_GROUP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TYPE_PORT_GROUP";default:return"COMMON_UNKNOWN"}},i=e=>{switch(e){case n.FirewallRuleAction.ACCEPT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ACTION_ACCEPT";case n.FirewallRuleAction.DROP:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ACTION_DROP";case n.FirewallRuleAction.REJECT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ACTION_REJECT";default:return"COMMON_UNKNOWN"}},R=e=>"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_ICMP_TYPENAME_"+(e||"none").replace(/-/g,"_").toUpperCase(),A=e=>{switch(e){case n.FirewallRuleRulesetV4.GUEST_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUEST_IN";case n.FirewallRuleRulesetV4.GUEST_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUEST_LOCAL";case n.FirewallRuleRulesetV4.GUEST_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUEST_OUT";case n.FirewallRuleRulesetV4.LAN_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LAN_IN";case n.FirewallRuleRulesetV4.LAN_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LAN_LOCAL";case n.FirewallRuleRulesetV4.LAN_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LAN_OUT";case n.FirewallRuleRulesetV4.WAN_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WAN_IN";case n.FirewallRuleRulesetV4.WAN_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WAN_LOCAL";case n.FirewallRuleRulesetV4.WAN_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WAN_OUT";case n.FirewallRuleRulesetV6.GUESTV6_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUESTV6_IN";case n.FirewallRuleRulesetV6.GUESTV6_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUESTV6_LOCAL";case n.FirewallRuleRulesetV6.GUESTV6_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_GUESTV6_OUT";case n.FirewallRuleRulesetV6.LANV6_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LANV6_IN";case n.FirewallRuleRulesetV6.LANV6_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LANV6_LOCAL";case n.FirewallRuleRulesetV6.LANV6_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_LANV6_OUT";case n.FirewallRuleRulesetV6.WANV6_IN:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WANV6_IN";case n.FirewallRuleRulesetV6.WANV6_LOCAL:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WANV6_LOCAL";case n.FirewallRuleRulesetV6.WANV6_OUT:return"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_RULES_RULESET_WANV6_OUT";default:return"COMMON_UNKNOWN"}},s=e=>{let t=Math.min(...e.map(({rule_index:e})=>Number(e)));return e.map(e=>({...e,rule_index:(t++).toString()}))}},2606:function(e,t,l){"use strict";var a=l(0),E=l.n(a),_=l(3),r=l(2),n=l(36),T=l(1763),c=l(1761),o=l(2379),i=l(1762),R=l(821),A=l(38),s=l(2541);const u=Object(_.c)("div")`
  flex: none;
  padding-top: ${({hasItems:e})=>e?0:"12px"};
  width: 100%;
`;t.a=({modalForm:e=!1})=>{const{setFieldValue:t,setFieldTouched:l,values:a,errors:_,touched:N}=Object(n.e)();return E.a.createElement(T.a,{padding:e?"none":void 0},E.a.createElement(c.a,null,!e&&E.a.createElement(o.a,{alignWith:"input",htmlFor:"name",label:E.a.createElement(r.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_NAME_LABEL"})}),E.a.createElement(i.a,{column:!0},E.a.createElement(A.Field,{full:!0,name:"name",label:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_NAME_LABEL"}))),E.a.createElement(c.a,null,!e&&E.a.createElement(o.a,{alignWith:"dropdown",htmlFor:"group_type",label:E.a.createElement(r.c,{id:"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_TYPE_LABEL"})}),E.a.createElement(i.a,{column:!0},E.a.createElement(A.Field,{full:!0,name:"group_type",options:s.a,translateOptions:!0,type:"dropdown"}))),E.a.createElement(c.a,null,!e&&E.a.createElement(o.a,{alignWith:"input",htmlFor:"group_members[0]",label:E.a.createElement(r.c,{id:a.group_type===R.FirewallGroupType.PORT_GROUP?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_PORT_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_LABEL"})}),E.a.createElement(i.a,{column:!0},E.a.createElement(u,{hasItems:a.group_members.length>0},E.a.createElement(A.NewMultiInput,{addButtonLabel:a.group_type===R.FirewallGroupType.PORT_GROUP?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_PORT_ADD":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_ADD",label:a.group_type===R.FirewallGroupType.PORT_GROUP?"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_PORT_LABEL":"SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_FORM_FIELD_GROUP_MEMBERS_ADDRESS_LABEL",min:1,max:1e3,name:"group_members",values:a.group_members,onChange:e=>t("group_members",e),errors:null==_?void 0:_.group_members,touched:null==N?void 0:N.group_members,onBlur:e=>l(`group_members[${e}]`,!0)})))))}},821:function(e,t,l){"use strict";l.r(t),l.d(t,"fetchFirewallGroups",(function(){return n})),l.d(t,"saveFirewallGroup",(function(){return T})),l.d(t,"removeFirewallGroup",(function(){return c})),l.d(t,"MODEL",(function(){return _})),l.d(t,"PATH",(function(){return r})),l.d(t,"firewallGroupsSelector",(function(){return A})),l.d(t,"selectFirewallGroups",(function(){return s})),l.d(t,"selectFirewallGroup",(function(){return u})),l.d(t,"FirewallGroupType",(function(){return N}));var a=l(25),E=l(7);const _="firewallgroup",r="/api/s/{site}/rest/"+_,n=(e,t)=>Object(E.q)(_,r,e,{...t,idField:"_id"}),T=e=>e._id?Object(E.D)(_,e._id,`${r}/${e._id}`,e):Object(E.i)(_,r,e),c=({id:e,name:t})=>Object(E.n)(_,e,`${r}/${e}`,{},Object(a.a)("SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TOAST_REMOVE_FAILURE","SETTINGS_INTERNET_THREAT_MANAGEMENT_FIREWALL_GROUPS_TOAST_REMOVE_SUCCESS",{name:t}));var o=l(54),i=l(73),R=l(6);const A=Object(E.A)(n()),s=Object(R.a)(A,e=>Object(o.a)(e,"data",[])),u=Object(R.a)(s,e=>Object(i.a)(t=>e.find(({_id:e})=>e===t)));var N;!function(e){e.PORT_GROUP="port-group",e.ADDRESS_GROUP="address-group",e.IPV6_ADDRESS_GROUP="ipv6-address-group"}(N||(N={}))}}]);
//# sourceMappingURL=47.f400b1db6c26e1693504.js.map