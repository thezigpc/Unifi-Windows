(window.webpackJsonpunifiNetworkUi=window.webpackJsonpunifiNetworkUi||[]).push([[14],{2435:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return F})),a.d(t,"b",(function(){return H})),a.d(t,"e",(function(){return $})),a.d(t,"f",(function(){return z})),a.d(t,"g",(function(){return W})),a.d(t,"d",(function(){return q}));var n=a(0),l=a.n(n),i=a(3),r=a(1898),c=a(9);const o=Object(i.c)(c.a)`
  padding: 0 ${({theme:e})=>e.space[4]}px;
  border-bottom: 1px ${({theme:e})=>e.colors.border} solid;
  box-sizing: border-box;
`,s=Object(i.c)(r.a)`
  bottom: -1px;
`;var d=({isLoading:e,children:t,...a})=>l.a.createElement(o,Object.assign({},a,{flex:"none",className:"base-control-panel",position:"relative",alignItems:"center",justifyContent:"space-between",height:50}),t,l.a.createElement(s,{isLoading:e,placement:"bottom"})),u=a(2),m=a(5),b=a(18);const p=e=>{var t;return null===(t=null==e?void 0:e.filters)||void 0===t?void 0:t.isFilterOpen};var v=a(868),g=a(2382),O=a(2894),E=a(2877),f=a(577),h=a(2823);const j=Object(i.c)(h.a)`
  padding: 24px;
`;var _=({columns:e,columnLabels:t,tableType:a})=>{var i;const r=Object(m.useDispatch)(),c=(null===(i=Object(m.useSelector)(Object(b.I)(a)))||void 0===i?void 0:i.initialColumns)||[],o=Object(n.useMemo)(()=>Object.values(e).every(e=>c.includes(e)),[c]),s=Object(n.useCallback)(()=>{const t=o||(null==c?void 0:c.length)?[]:Object.values(e);r(Object(b.S)(a,{initialColumns:t},!0))},[r,o,a,c]),d=Object(n.useMemo)(()=>[{full:!0,id:"showAllFields",checked:o||!!(null==c?void 0:c.length)&&"mixed",children:l.a.createElement(u.c,{id:"COMMON_COLUMN_VISIBILITY_SHOW_ALL_FIELD"}),onChange:s}].concat(Object.values(e).map(e=>({full:!0,id:e,checked:c.includes(e),children:(null==t?void 0:t[e])?l.a.createElement(u.b,{id:t[e]}):e,onChange:({target:{checked:t}})=>{const n=t?[...c,e]:c.filter(t=>t!==e);r(Object(b.S)(a,{initialColumns:n},!0))}}))),[c,a]);return l.a.createElement(j,{spacing:"flush",items:d,variant:"list"})};const C=Object(i.c)(g.a)`
  width: 258px !important;
`;var T;!function(e){e.COLUMNS="columns",e.FILTERS="filters"}(T||(T={}));var y=({filterTitleLabel:e,isOpen:t,onClose:a,columnTabProps:i,renderFilterDrawerContent:r,footerProps:c})=>{var o;const[s,d]=Object(n.useState)(T.FILTERS),{tableType:p}=i||{tableType:null},v=Object(m.useDispatch)(),g=(null===(o=Object(m.useSelector)(Object(b.I)(p)))||void 0===o?void 0:o.initialColumns)||[],h=c&&s===T.COLUMNS,j=Object(n.useMemo)(()=>{var e,t;return h&&Object(f.a)(null===(t=null===(e=null===b.c||void 0===b.c?void 0:b.c.tables)||void 0===e?void 0:e[p])||void 0===t?void 0:t.initialColumns,g)},[h,p,g]),y=Object(n.useCallback)(()=>{var e,t,a;const n=[...null!==(a=null===(t=null===(e=null===b.c||void 0===b.c?void 0:b.c.tables)||void 0===e?void 0:e[p])||void 0===t?void 0:t.initialColumns)&&void 0!==a?a:[]];v(Object(b.S)(p,{initialColumns:n},!0))},[v,p]),S=Object(n.useCallback)(({id:e})=>d(e),[d]),w=i?l.a.createElement(O.a,{onSelectTab:S,tabs:[{id:T.FILTERS,label:l.a.createElement(u.c,{id:"COMMON_CONTROL_PANEL_FILTERS"}),render:r},{id:T.COLUMNS,label:l.a.createElement(u.c,{id:"COMMON_CONTROL_PANEL_COLUMNS"}),render:()=>l.a.createElement(_,{columns:i.columns,columnLabels:i.columnLabels,tableType:p})}]}):r(),x=Object(n.useMemo)(()=>h?{label:l.a.createElement(u.c,{id:"COMMON_CONTROL_PANEL_FILTER_FOOTER_RESTORE_COLUMNS"}),onClick:y,disabled:j}:c,[h,c,j,y]),M=Object(n.useCallback)(()=>{a(),d(T.FILTERS)},[a,d]);return l.a.createElement(C,{in:t,renderHeader:()=>null,onClose:a,side:"left"},t&&l.a.createElement(E.a,{footerProps:x,headerProps:{label:e},onClose:M},w))},S=a(42),w=a(23),x=a(786);var M=({items:e,...t})=>{const{params:a,path:n}=Object(w.n)(),i=Object(w.l)(),r=Object(w.k)(),c=e.find(({path:e})=>e===n)||((e,{pathname:t})=>e.find(({path:e})=>new RegExp(e.replace(/\/:\w+\?.*/g,"/?.*").replace(/:\w+/g,"\\w+").replace(/\//g,"\\$&")).test(t)))(e,i);return l.a.createElement(x.a,Object.assign({tabs:e,selectedTab:null==c?void 0:c.id,onSelectTab:({path:e,params:t={}})=>r.push(Object(w.i)(e,{...a,...t}))},t))};const k=Object(i.c)(M)`
  height: 100%;
  position: absolute;
  left: 0;
  right: 0;
  div,
  button {
    height: 100% !important;
  }
`;var A=({routes:e})=>{const t=Object(n.useMemo)(()=>e&&e.map(({id:e,label:t,disabled:a,path:n,...l})=>({id:e,label:t,disabled:"function"==typeof a?a(l):a,path:n})),[e]);return t?l.a.createElement(k,{selectedTabBold:!0,items:t}):null},I=a(2895);const N=Object(i.c)(I.a)`
  padding: 0 8px;
  z-index: 5;
`;var D=({filterTitleLabel:e,filtersActive:t,items:a})=>{const n=Object(m.useDispatch)();return l.a.createElement(c.a,{height:"100%"},l.a.createElement(N,{title:e,onClick:()=>n(Object(v.b)(!0)),filtersActive:t}),a)};const L=Object(i.c)(S.a,{shouldForwardProp:e=>"hideFilterButton"!==e})`
  font-size: 14px;
  ${({hideFilterButton:e})=>e&&"margin-left: 50%;"}
  position: absolute;
  transform: translateX(-50%);
  left: 50%;
`;var R=({routes:e=[],hideFilterButton:t=!1,isLoading:a,children:n,filterTitleLabel:i,filtersActive:r,items:o,title:s})=>{const m=(null==e?void 0:e.length)>1,b=!m&&1===e.length;return l.a.createElement(d,{isLoading:a},!t&&l.a.createElement(D,{filterTitleLabel:i,items:o,filtersActive:r}),m&&l.a.createElement(A,{routes:e}),b&&l.a.createElement(L,{weight:"bold"},e[0].label),s&&l.a.createElement(L,{weight:"bold",hideFilterButton:t},l.a.createElement(u.c,{id:s})),l.a.createElement(c.a,{height:"100%",flex:m||s||b?"none":1,alignItems:"center",justifyContent:"flex-end"},n))};var F=Object(u.f)(({routes:e=[],hideFilterButton:t=!1,isLoading:a,children:i,filterFooterProps:r,columnTabProps:c,renderFilterDrawerContent:o,filterTitleLabel:s,filtersActive:d,items:u,title:g,onClose:O,intl:E})=>{var f;const h=Object(m.useDispatch)(),j=Object(m.useSelector)(p),_=(null===(f=Object(m.useSelector)(Object(b.I)(null==c?void 0:c.tableType)))||void 0===f?void 0:f.initialColumns)||[],C=E.formatMessage({id:s||"COMMON_CONTROL_PANEL_FILTER_TITLE"});Object(n.useEffect)(()=>()=>{h(Object(v.b)(!1))},[]);const T=Object(n.useCallback)(()=>{h(Object(v.b)(!1)),null==O||O(),(null==c?void 0:c.tableType)&&h(Object(b.S)(c.tableType,{initialColumns:_}))},[h,O,null==c?void 0:c.tableType,_]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(y,{isOpen:j,filterTitleLabel:C,onClose:T,columnTabProps:c,renderFilterDrawerContent:()=>j&&o,footerProps:r}),l.a.createElement(R,{routes:e,hideFilterButton:t,isLoading:a,filterTitleLabel:C,filtersActive:d,items:u,title:g},i))}),P=a(168);var H=Object(i.c)(P.a)`
  padding-left: ${({theme:e})=>e.space[3]}px;
  padding-right: ${({theme:e})=>e.space[3]}px;
  color: ${({theme:e})=>e.colors.subtlerText};
  &:hover {
    color: ${({theme:e})=>e.colors.mediumText};
  }
`,B=a(2425);var $=Object(i.c)(B.a)`
  padding-left: ${({theme:e})=>e.space[2]}px;
  padding-right: ${({theme:e})=>e.space[2]}px;
`;var z=Object(i.c)("span")`
  border-right: 1px ${({theme:e})=>e.colors.border} solid;
  margin: 0 ${({theme:e})=>e.space[4]}px;
  position: relative;
  height: 100%;
  display: block;
`;const U=i.a`
  align-items: center;
  display: flex;
  height: 100%;
  width: auto;
  justify-content: flex-end;
  overflow-x: unset;

  > div {
    margin: initial;
  }
`,V=i.a`
  max-height: 30px;
  padding: 0 5px !important;
  margin: 0 5px;
`;function W(e){return l.a.createElement(x.a,Object.assign({className:U,tabClassName:V},e))}var G=a(1758);const Y=Object(i.c)(S.a)`
  line-height: 24px;
  color: ${({theme:e})=>e.motifPalette.text01};
`,K=Object(i.c)("div",{shouldForwardProp:e=>"toggleStyle"!==e})`
  justify-content: space-between;
  margin-top: ${({toggleStyle:e})=>{var t;return null!==(t=null==e?void 0:e.marginTop)&&void 0!==t?t:8}}px;
  margin-right: ${({toggleStyle:e})=>{var t;return null!==(t=null==e?void 0:e.marginRight)&&void 0!==t?t:0}}px;
  margin-bottom: ${({toggleStyle:e})=>{var t;return null!==(t=null==e?void 0:e.marginBottom)&&void 0!==t?t:0}}px;
  margin-left: ${({toggleStyle:e})=>{var t;return null!==(t=null==e?void 0:e.marginLeft)&&void 0!==t?t:0}}px;
  width: auto !important;

  label {
    margin-left: 0;
  }
`;var q=({checked:e,disabled:t,id:a,onChange:n,text:i,toggleStyle:r})=>l.a.createElement(K,{toggleStyle:r},l.a.createElement(G.a,{checked:e,id:a,onChange:n,disabled:t},"string"==typeof i?l.a.createElement(Y,{size:"body"},l.a.createElement(u.c,{id:i})):i))},2445:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t)=>{const a=Object.keys(e||{}),n=Object.keys(t||{});return a.length===n.length&&n.every(a=>e[a]&&e[a].length===t[a].length&&t[a].every(t=>e[a].includes(t)))}},2490:function(e,t,a){"use strict";var n,l=a(0),i=a.n(l),r=a(3),c=a(1179),o=a(26),s=a(45),d=a(42),u=a(2),m=a(5),b=a(14),p=a(188),v=a(578),g=a(168);!function(e){e.DEFAULT="default",e.HOVER="hover",e.DISABLED="disabled",e.ACTIVE="active"}(n||(n={}));const O={[n.DEFAULT]:{light:"#d6d9e2",dark:"#3f3f3f"},[n.HOVER]:{light:"#7e8190",dark:"#9d9d9d"},[n.DISABLED]:{light:"#eeeff3",dark:"#1e1e1e"},[n.ACTIVE]:{light:"#a4a7b5",dark:"#2f2f2f"}},E=(e,t)=>O[t][e],f=(e,t)=>"1px 0px 0px 0px "+E(e,t),h=Object(r.c)(g.a,{shouldForwardProp:e=>"rotate"!==e})`
  margin: 0;
  padding: 0;
  width: 26px;
  height: 24px;
  color: inherit;
  background-color: transparent;
  box-sizing: border-box;
  border-radius: 4px 0 0 4px;
  border-right: 0;
  border-color: transparent;
  border-color: ${({motif:e})=>""+E(e,n.DEFAULT)};
  box-shadow: ${({motif:e})=>""+f(e,n.DEFAULT)};
  ${({rotate:e=!1})=>e?"\n    transform: rotate(-180deg);\n  ":"\n  position: relative; \n  left: -1px;\n    "}
  > span {
    display: flex;
    align-items: center;
    justify-content: center;
    > div {
      display: flex;
    }
  }
  &:disabled {
    z-index: 0;
    box-shadow: ${({motif:e})=>f(e,n.DISABLED)+" !important"};
    border-color: ${({motif:e})=>E(e,n.DISABLED)+" !important"};
  }
  &:hover {
    z-index: 1;
    box-shadow: ${({motif:e})=>f(e,n.HOVER)+" !important"};
    border-color: ${({motif:e})=>E(e,n.HOVER)+" !important"};
    border-right: 0;
    background-color: transparent !important;
  }
  &:active {
    box-shadow: ${({motif:e})=>f(e,n.ACTIVE)+" !important"};
    border-color: ${({motif:e})=>E(e,n.ACTIVE)+" !important"};
  }
`;var j=({disabled:e,onClick:t,rotate:a,motif:n})=>i.a.createElement(h,{variant:"secondary",rotate:a,disabled:e,onClick:t,motif:n},i.a.createElement("svg",{width:"4",height:"8",viewBox:"0 0 4 8",fill:"none"},i.a.createElement("path",{d:"M3.75026 0.999386C3.75026 1.11739 3.70826 1.23639 3.62426 1.33138L1.25026 3.99939L1.27026 4.02039L3.62326 6.66739C3.80726 6.87339 3.78826 7.18939 3.58226 7.37339C3.37626 7.55739 3.06026 7.53839 2.87626 7.33239L0.530256 4.69439C0.156256 4.30739 0.156256 3.69139 0.530256 3.30439L2.87526 0.667385C3.05826 0.461386 3.37526 0.442385 3.58126 0.626385C3.69326 0.724385 3.75026 0.861386 3.75026 0.999386Z",fill:"#A4A7B5"})));const _=Object(r.c)(b.g)`
  table {
    z-index: 1;
  }
`,C=Object(r.c)(c.a)`
  > div > div {
    height: 28px;
    > div:first-child {
      ${({theme:e,motif:t})=>`\n      margin-top: ${e.spacing["spacing-xs"]};\n      color: ${"dark"===t?"#c2c2c2":o.a["grey-2"]} !important;\n      -webkit-text-fill-color: ${"dark"===t?"#c2c2c2":o.a["grey-2"]} !important;\n    `}
    }
    > div:last-child {
      margin-top: 8px;
    }
  }
`,T=[{value:"25",default:!0},{value:"50"},{value:"100"}];t.a=({onRenderTable:e,customContent:t,items:a,section:n,rowOptions:r,onRowsChanged:c,onPageChanged:o,tableType:g,totalItems:O=(null==a?void 0:a.length)||0,pageNumber:E})=>{const{motif:f}=Object(s.a)(),h=Object(m.useDispatch)(),y=Object(l.useMemo)(()=>r||T,[r]),S=Object(l.useMemo)(()=>y.map(({value:e})=>({label:e,value:e})),[y]),w=Object(m.useSelector)(Object(p.w)(g)),x=Object(l.useMemo)(()=>{var e,t;return Number((null==w?void 0:w.rowsPerPage)&&S.some(({value:e})=>Number(e)===w.rowsPerPage)?w.rowsPerPage:(null===(e=y.find(e=>null==e?void 0:e.default))||void 0===e?void 0:e.value)||(null===(t=null==y?void 0:y[0])||void 0===t?void 0:t.value))},[w,S,y]),M=Object(l.useMemo)(()=>Math.max(1,E||0),[E]),k=Object(l.useCallback)(e=>{null==o||o(e)},[o,h]),A=Object(l.useCallback)(()=>{k(M-1)},[M,k]),I=Object(l.useCallback)(()=>{k(M+1)},[M,k]),N=Object(l.useCallback)(({value:e})=>{const t=Number(e);h(Object(v.k)(g,{rowsPerPage:t})),null==c||c(t)},[h,c,g]),D=Object(l.useMemo)(()=>{let e=(M-1)*x+1;return e>(null==a?void 0:a.length)&&(e=(null==a?void 0:a.length)-x,k(Math.ceil(Math.ceil(e)/x+1))),e},[k,M,x,null==a?void 0:a.length]),L=Object(l.useMemo)(()=>{let e=D+x-1;return e>=(null==a?void 0:a.length)&&(e=null==a?void 0:a.length),e},[D,x,null==a?void 0:a.length]),R=Object(l.useMemo)(()=>({from:Math.max(0,D-1),rowsPerPage:x}),[D,x]),F=Object(l.useMemo)(()=>1===M,[M]),P=Object(l.useMemo)(()=>L>=(null==a?void 0:a.length),[L,null==a?void 0:a.length]),H=Object(l.useMemo)(()=>O>x||1!==D,[O,x,D]);return i.a.createElement(_,{padding:"32px",width:"100%",height:"100%",flexDirection:"column",overflow:"auto"},H?i.a.createElement(i.a.Fragment,null,e(R),i.a.createElement(b.g,{marginTop:16,justifyContent:"space-between"},i.a.createElement(b.g,{alignItems:"center"},i.a.createElement(b.g,{marginRight:8},i.a.createElement(d.a,{color:"secondary"},i.a.createElement(u.c,{id:"PAGINATION",values:{from:D,to:L,total:O,section:i.a.createElement(u.c,{id:n})}}))),i.a.createElement(b.g,{marginRight:24},i.a.createElement(d.a,{color:"secondary"},i.a.createElement(j,{disabled:F,onClick:A,motif:f})),i.a.createElement(d.a,{color:"secondary"},i.a.createElement(j,{disabled:P,rotate:!0,onClick:I,motif:f}))),i.a.createElement(b.g,{alignItems:"center"},i.a.createElement(b.g,{marginRight:8},i.a.createElement(d.a,{color:"secondary"},i.a.createElement(u.c,{id:"ROWS_PER_PAGE"}))),i.a.createElement(C,{value:null==x?void 0:x.toString(),width:48,options:S,onChange:N,motif:f}))),t)):i.a.createElement(i.a.Fragment,null,e(R)))}},2700:function(e,t){},2710:function(e,t){},2867:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(23),r=a(5),c=a(17),o=a(94),s=a(32),d=a(183),u=a(573),m=a(40),b=a(232),p=a(302),v=a(30),g=a(7),O=a(1797),E=a(3),f=a(579),h=a(2),j=a(786),_=a(14),C=a(2435),T=a(2445),y=a(203),S=a(116),w=a(18),x=a(132),M=a(72),k=a(1815),A=a(106),I=a(64),N=a(647),D=a(572);const L=E.a`
  align-items: center;
  display: flex;
  height: 100%;
  justify-content: flex-end;
  padding-right: 12px;
  overflow-x: unset !important;

  > div {
    margin: initial;
  }
`,R=Object(E.c)(A.a)`
  text-transform: uppercase;
`,F=Object(E.c)("div")`
  display: flex;
  align-items: center;
  white-space: nowrap;
`,P=Object(E.c)(j.a,{shouldForwardProp:e=>"hasCustomRange"!==e})`
  @media (max-width: 720px) {
    padding: 0;
  }
  ${({hasCustomRange:e})=>e?"@media (max-width: 1075px) {\n    & > * > button {\n      display: none;\n      &:nth-last-of-type(1) {\n        display: flex;\n      }\n    }\n  }":"@media (max-width: 870px) {\n    & > * > button {\n      display: none;\n      &:nth-last-of-type(1) {\n        display: flex;\n      }\n    }\n  }"}
`,H=E.a`
  background-color: transparent !important;
`,B=(e,t)=>{const a=e.map(e=>({id:e.id,label:l.a.createElement(R,{size:"small",message:e.message,values:e.messageValues})}));return t&&a.push({id:"Custom",className:H,label:t}),a};var $=({tabsVariant:e})=>{const t=Object(r.useDispatch)(),a=Object(r.useSelector)(D.n),i=Object(r.useSelector)(v.selectLocaleSettings),c=Object(r.useSelector)(w.P),o=Object(r.useSelector)(D.d),s=Object(r.useSelector)(M.c),d=Object(I.d)(c,i,s),[u,m]=Object(n.useState)(null===o.preset?"Custom":o.preset),b=Object(n.useCallback)(e=>{t(Object(N.d)(e))},[t]),p=Object(n.useCallback)(e=>{const t=a.find(t=>t.id===e);t&&b({...t.getRange(new Date),preset:e}),m(e)},[a,b]);Object(n.useEffect)(()=>{o.preset||m("Custom")},[o.preset]);const g=Object(n.useMemo)(()=>o.preset?null:l.a.createElement(F,null,l.a.createElement(k.a,{start:o.startDate,end:o.endDate,timezone:d})),[o,d]);return l.a.createElement(P,{tabs:B(a,g),selectedTab:u,onSelectTab:({id:e})=>p(e),className:L,variant:e,hasCustomRange:!o.preset})},z=a(1262),U=a(710),V=a(2405),W=a(1179),G=a(2847),Y=a(251),K=a(21),q=a(176),Z=a(1268);const J=Object(E.c)("div")`
  padding: 24px;
`,X=Object(E.c)("div")`
  margin-bottom: 16px;
`,Q=Object(E.c)(V.a)`
  > div {
    color: inherit !important;
  }

  > div:last-of-type {
    padding-bottom: 17px;
  }

  span {
    font-size: 12px;
  }
`,ee=["<"+Object(q.b)(1e6),Object(q.b)(1e9)],te=e=>Object(q.b)(e);var ae=Object(h.f)(({intl:e})=>{const t=Object(r.useDispatch)(),a=Object(r.useSelector)(D.l),c=Object(r.useSelector)(D.j),o=Object(r.useSelector)(v.selectIpsSettings),[s,d]=Object(n.useState)(o.ips_mode!==v.IpsMode.DISABLED),u=Object(r.useSelector)(v.selectDpiSettings),[m,b]=Object(n.useState)(u.enabled),p=Object(n.useMemo)(()=>Object(Z.c)(c,e),[c,e]),{threatPage:g}=Object(i.m)(),O=g===U.a.MAP;Object(n.useEffect)(()=>{d(o.ips_mode!==v.IpsMode.DISABLED)},[o.ips_mode]);const E=Object(n.useCallback)(e=>{t(Object(y.i)({name:S.a.THREAT_MANAGEMENT,value:e})),t(Object(w.S)(x.a.THREAT_MANAGEMENT_EVENT_TIMELINE,{filters:e}))},[t]),f=Object(n.useCallback)(({value:e})=>{E(Object.assign({},a,{client:e}))},[E,a]),j=Object(n.useCallback)(e=>{E(Object.assign({},a,{transferSizeEnabled:e.target.checked}))},[E,a]),_=Object(n.useCallback)(e=>{E(Object.assign({},a,{transferSizeMin:e.target.value}))},[E,a]),T=Object(n.useCallback)(e=>{const n=e.target.checked;if(n&&!m)return b(!0),void t(Object(v.saveSettings)({...u,enables:!0}));E(Object.assign({},a,{traffic:n}))},[E,a,m,t,u]),M=Object(n.useCallback)(e=>{const n=e.target.checked;if(o.ips_mode===v.IpsMode.DISABLED)t(Object(Y.a)({title:n?"TM_ENABLE_IDS":"TM_DISABLE_IDS",message:n?"TM_ENABLE_IDS_DESC":"TM_DISABLE_IDS_DESC",confirmButtonProps:n?{text:l.a.createElement(h.c,{id:"COMMON_ACTION_ENABLE"})}:{text:l.a.createElement(h.c,{id:"COMMON_ACTION_DISABLE"}),variant:"danger"},onConfirm:()=>{d(n),t(Object(v.saveSettings)({...o,ips_mode:n?v.IpsMode.IPS:v.IpsMode.DISABLED})),t(Object(K.e)())},onCancel:()=>{t(Object(K.e)())}}));else{const e={threats:n};e.severity=n?[...z.d.severity]:[],E(Object.assign({},a,e))}},[t,o,a,E]);return l.a.createElement(J,null,l.a.createElement(X,null,l.a.createElement(W.a,{placeholder:e.formatMessage({id:"TM_SELECT_CLIENT"}),options:p,renderOption:G.a,renderSelectedOption:G.b,arrowSize:"medium",inputProps:{style:{height:60}},searchable:!0,maxHeight:450,width:208,onChange:f,value:a.client})),!O&&l.a.createElement(C.d,{checked:m&&a.traffic,onChange:T,id:"traffic",text:"TM_TRAFFIC_ANALYSIS",toggleStyle:{marginTop:4,marginBottom:16}}),l.a.createElement(C.d,{checked:s&&a.threats,onChange:M,id:"threats",text:"TM_THREAT_SEVERITY",toggleStyle:{marginTop:4,marginBottom:16}}),l.a.createElement(C.d,{checked:null==a?void 0:a.transferSizeEnabled,onChange:j,id:"transferSizeEnabled",text:"TM_TRANSFER_SIZE",toggleStyle:{marginTop:4,marginBottom:16}}),l.a.createElement(Q,{value:a.transferSizeMin,onChange:_,min:1e6,max:1e9,step:100,segments:1,segmentLabels:ee,withValueIndicator:a.transferSizeEnabled&&a.transferSizeMin>z.d.transferSizeMin,formatValueIndicatorContent:te,valueIndicatorPosition:"bottom",disabled:!(null==a?void 0:a.transferSizeEnabled)}))});const ne=Object(E.c)("div",{shouldForwardProp:e=>!["hasCustomRange","hasFilterToggle"].includes(e)})`
  font-size: 14px;
  justify-content: center;
  ${({hasFilterToggle:e})=>e?"margin-right: 176px;":""}
  width: 100%;
  ${({hasCustomRange:e})=>e?"@media (max-width: 750px) {\n    margin: 0 300px 0 auto;\n  }":"@media (max-width: 410px) {\n    margin: 0 180px 0 auto;\n  }"}
`,le=Object(E.c)(_.g)`
  position: absolute;
  right: 36px;
`;var ie=()=>{const e=Object(n.useRef)(null),t=Object(r.useDispatch)(),a=Object(i.k)(),{threatPage:c}=Object(i.m)(),o=c===U.a.MAP,s=c||z.e[U.a.TIMELINE],d=Object(r.useSelector)(D.d),u=Object(m.a)("/ips"),b=Object(n.useCallback)(e=>{a.push(`${u}/${z.e[e.id]}`)},[]),p=Object(m.q)(e),v=Object(r.useSelector)(D.l),g=Object(n.useMemo)(()=>Object(T.a)(v,z.d),[v]),O=Object(n.useCallback)(()=>{t(Object(y.h)({name:S.a.THREAT_MANAGEMENT})),t(Object(w.S)(x.a.THREAT_MANAGEMENT_EVENT_TIMELINE,{filters:Object(f.a)(z.d)}))},[t]);return l.a.createElement("div",{ref:e},l.a.createElement(C.c,{isLoading:!1,hideFilterButton:p>z.a-(o?178:0)+66,renderFilterDrawerContent:l.a.createElement(ae,null),filterFooterProps:{label:l.a.createElement(h.c,{id:"COMMON_CONTROL_PANEL_FILTER_FOOTER_RESTORE_DEFAULTS"}),onClick:O,disabled:g},filtersActive:!g},l.a.createElement(ne,{hasCustomRange:!d.preset,hasFilterToggle:p<z.a},l.a.createElement(j.a,{tabs:z.f,selectedTab:s,onSelectTab:b})),l.a.createElement(le,null,l.a.createElement($,{tabsVariant:"tertiary"}))))},re=a(2397),ce=a(1895),oe=a(1214),se=a(168),de=a(10),ue=a(167),me=a(417),be=a(39),pe=a(57),ve=a(2490),ge=a(98),Oe=a(638),Ee=a(179),fe=a(174),he=a(696),je=a(83),_e=a(393),Ce=a(1758),Te=a(42);const ye=Object(E.c)(_.g)`
  border-radius: 8px;
  border: 1px solid ${({theme:e})=>e.motifPalette.neutral04};
  padding: 10px 16px;
  height: 90px;
  margin-bottom: 16px;
  background: ${({theme:e})=>e.motifPalette.ui01}CD;
`,Se=Object(E.c)(_.g)`
  height: 90px;
  margin-bottom: 16px;
`,we=Object(E.c)("div")`
  align-self: center;
  width: 100%;

  > div > div > div {
    padding: 10px 16px;
    border: 1px solid ${({theme:e})=>e.motifPalette.neutral04};
    border-radius: 8px;
    height: 90px;
    width: 280px;
    background: ${({theme:e})=>e.motifPalette.ui01}CD;
    box-shadow: none !important;

    &:after {
      display: none !important;
    }
  }

  ul {
    border: 0 !important;
  }
`,xe=Object(E.c)(_e.a)`
  margin-right: 8px;
`,Me=Object(E.c)(Ce.a)`
  width: 100%;
`,ke=Object(E.c)("div",{shouldForwardProp:e=>"chipChecked"!==e&&"isDark"!==e})`
  > div {
    transform: none !important;
    margin: 0 !important;
    ${({chipChecked:e,theme:t,isDark:a})=>e?`\n      background: ${t.motifPalette[a?"uBlue10":"uBlue01"]};\n      border-color: ${t.motifPalette[a?"uBlue10":"uBlue01"]};\n\n      &:hover {\n        background: ${t.motifPalette[a?"uBlue09":"uBlue02"]};\n        border-color: ${t.motifPalette[a?"uBlue09":"uBlue02"]};\n      }\n    `:`\n      background: ${t.motifPalette.neutral02};\n      border-color: ${t.motifPalette.neutral02};\n\n      &:hover {\n        background: ${t.motifPalette.neutral03};\n        border-color: ${t.motifPalette.neutral03};\n      }\n    `}
  }
`,Ae=Object(E.c)(V.a)`
  > div {
    color: inherit !important;
  }

  > div:last-of-type {
    padding-bottom: 17px;
  }

  span {
    font-size: 12px;
  }
`,Ie=["<"+Object(q.b)(1e6),Object(q.b)(1e9)],Ne=e=>Object(q.b)(e);var De=Object(h.f)(({intl:e,isMap:t})=>{const a=Object(n.useRef)(null),i=Object(m.q)(a),c=Object(r.useDispatch)(),o=Object(r.useSelector)(D.l),s=Object(r.useSelector)(D.j),d=Object(n.useMemo)(()=>Object(Z.c)(s,e),[s,e]),u=Object(r.useSelector)(v.selectIpsSettings),[b,p]=Object(n.useState)(u.ips_mode!==v.IpsMode.DISABLED),g=Object(r.useSelector)(v.selectDpiSettings),[O,E]=Object(n.useState)(g.enabled),f=Object(r.useSelector)(w.u);Object(n.useEffect)(()=>{p(u.ips_mode!==v.IpsMode.DISABLED),E(g.enabled)},[u.ips_mode,g.enabled]);const j=Object(n.useCallback)(e=>{c(Object(y.i)({name:S.a.THREAT_MANAGEMENT,value:e})),c(Object(w.S)(x.a.THREAT_MANAGEMENT_EVENT_TIMELINE,{filters:e}))},[c]),C=Object(n.useCallback)(({value:e})=>{j(Object.assign({},o,{client:e}))},[j,o]),T=Object(n.useCallback)(e=>{j(Object.assign({},o,{transferSizeEnabled:e.target.checked}))},[j,o]),M=Object(n.useCallback)(e=>{j(Object.assign({},o,{transferSizeMin:e.target.value}))},[j,o]),k=Object(n.useCallback)(e=>{const t=e.target.checked;if(t&&!O)return E(!0),void c(Object(v.saveSettings)({...g,enables:!0}));j(Object.assign({},o,{traffic:t}))},[j,o,O,c,g]),A=Object(n.useCallback)(()=>{k({target:{checked:!(O&&o.traffic)}})},[o.traffic,k,O]),I=Object(n.useCallback)(e=>{const t=e.target.checked;if(u.ips_mode===v.IpsMode.DISABLED)c(Object(Y.a)({title:t?"TM_ENABLE_IDS":"TM_DISABLE_IDS",message:t?"TM_ENABLE_IDS_DESC":"TM_DISABLE_IDS_DESC",confirmButtonProps:t?{text:l.a.createElement(h.c,{id:"COMMON_ACTION_ENABLE"})}:{text:l.a.createElement(h.c,{id:"COMMON_ACTION_DISABLE"}),variant:"danger"},onConfirm:()=>{p(t),c(Object(v.saveSettings)({...u,ips_mode:t?v.IpsMode.IPS:v.IpsMode.DISABLED})),c(Object(K.e)())},onCancel:()=>{c(Object(K.e)())}}));else{const e={threats:t};e.severity=t?[...z.d.severity]:[],j(Object.assign({},o,e))}},[c,u,o,j]),N=Object(n.useCallback)((e,t)=>{const a={severity:[...o.severity]};a.severity[e]=t,a.severity.includes(!0)||(a.threats=!1),a.severity.slice(1).includes(!0)&&!o.threats&&(a.threats=!0),j(Object.assign({},o,a))},[o,j]);return l.a.createElement("div",{ref:a},l.a.createElement(_.g,{justifyContent:"space-between",flexWrap:"wrap"},i>=z.a-(t?178:0)&&l.a.createElement(l.a.Fragment,null,l.a.createElement(Se,{width:280,alignSelf:"flex-start"},l.a.createElement(we,null,l.a.createElement(W.a,{placeholder:e.formatMessage({id:"TM_SELECT_CLIENT"}),options:d,renderOption:G.a,renderSelectedOption:G.b,arrowSize:"medium",inputProps:{style:{height:90}},searchable:!0,maxHeight:450,width:280,onChange:C,value:o.client}))),l.a.createElement(_.g,{flexWrap:"wrap"},!t&&l.a.createElement(ye,{width:178,alignSelf:"flex-end",flexDirection:"column",marginRight:16},l.a.createElement(_.g,{marginBottom:8},l.a.createElement(Me,{checked:O&&o.traffic,onChange:k,size:"small"},l.a.createElement(h.b,{id:"TM_TRAFFIC_ANALYSIS"}))),l.a.createElement(_.g,{flex:"1",justifyContent:"space-between"},l.a.createElement(ke,{chipChecked:O&&o.traffic,isDark:f},l.a.createElement(oe.a,{width:"auto",onClick:A,label:l.a.createElement(_.g,{alignItems:"center"},l.a.createElement(xe,{variant:"info"}),l.a.createElement(Te.a,{weight:"bold"},l.a.createElement(h.b,{id:"TM_TRAFFIC"})))})))),l.a.createElement(ye,{width:445,alignSelf:"flex-end",flexDirection:"column",marginRight:16},l.a.createElement(_.g,{marginBottom:8},l.a.createElement(Me,{checked:b&&o.threats,onChange:I,size:"small"},l.a.createElement(h.b,{id:"TM_THREAT_SEVERITY"}))),l.a.createElement(_.g,{flex:"1",justifyContent:"space-between"},l.a.createElement(ke,{chipChecked:b&&o.threats&&o.severity[4],isDark:f},l.a.createElement(oe.a,{width:"auto",onClick:()=>N(4,!(b&&o.threats&&o.severity[4])),label:l.a.createElement(_.g,{alignItems:"center"},l.a.createElement(xe,{variant:"success"}),l.a.createElement(Te.a,{weight:"bold"},l.a.createElement(h.b,{id:"TM_KNOWN"})))})),l.a.createElement(ke,{chipChecked:b&&o.threats&&o.severity[2],isDark:f},l.a.createElement(oe.a,{width:"auto",onClick:()=>N(2,!(b&&o.threats&&o.severity[2])),label:l.a.createElement(_.g,{alignItems:"center"},l.a.createElement(xe,{variant:"warning"}),l.a.createElement(Te.a,{weight:"bold"},l.a.createElement(h.b,{id:"TM_UNKNOWN"})))})),l.a.createElement(ke,{chipChecked:b&&o.threats&&o.severity[1],isDark:f},l.a.createElement(oe.a,{width:"auto",onClick:()=>N(1,!(b&&o.threats&&o.severity[1])),label:l.a.createElement(_.g,{alignItems:"center"},l.a.createElement(xe,{variant:"danger"}),l.a.createElement(Te.a,{weight:"bold"},l.a.createElement(h.b,{id:"TM_CONCERNING"})))})),l.a.createElement(ke,{chipChecked:b&&o.threats&&o.severity[3],isDark:f},l.a.createElement(oe.a,{width:"auto",onClick:()=>N(3,!(b&&o.threats&&o.severity[3])),label:l.a.createElement(_.g,{alignItems:"center"},l.a.createElement(xe,{variant:"neutral"}),l.a.createElement(Te.a,{weight:"bold"},l.a.createElement(h.b,{id:"TM_BLOCKED"})))})))),l.a.createElement(ye,{width:282,alignSelf:"flex-end",flexDirection:"column"},l.a.createElement(_.g,{marginBottom:8},l.a.createElement(Me,{checked:o.transferSizeEnabled,onChange:T,size:"small"},l.a.createElement(h.b,{id:"TM_TRANSFER_SIZE"}))),l.a.createElement(_.g,{flex:"1"},l.a.createElement(Ae,{value:o.transferSizeMin,onChange:M,min:1e6,max:1e9,step:100,segments:1,segmentLabels:Ie,withValueIndicator:o.transferSizeEnabled&&o.transferSizeMin>z.d.transferSizeMin,formatValueIndicatorContent:Ne,valueIndicatorPosition:"bottom",disabled:!(null==o?void 0:o.transferSizeEnabled)})))))))}),Le=a(26),Re=a(1773),Fe=a(2882),Pe=a(119);const He=e=>3+Math.min(8-(1e9-e)/1e6/125|0,8),Be={[Oe.c.DAY]:[{value:60,label:"60 min"},{value:45,label:"45 min"},{value:30,label:"30 min"},{value:15,label:"15 min"},{value:0,label:"0 min"}],[Oe.c.WEEK]:[{value:24,label:"24.00hr"},{value:18,label:"18.00hr"},{value:12,label:"12.00hr"},{value:6,label:"6.00hr"},{value:0,label:"0hr"}]};var $e;!function(e){e.THREAT="threat",e.TRAFFIC="traffic",e.OVERALL="overall"}($e||($e={}));const ze=Object(E.c)(Te.a)`
  padding-bottom: 12px;
  margin-bottom: 12px;
  border-bottom: 1px solid ${({theme:e})=>e.motifPalette.ui11};
  width: 100%;
  position: relative;
  cursor: pointer;
`,Ue=Object(E.c)("div")`
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  width: 212px;
`,Ve=Object(E.c)(_.g)`
  margin-bottom: 8px;

  span:nth-child(2) {
    max-width: 150px;
    text-align: right;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
  }
`,We=Object(E.c)(Te.a)`
  color: ${Le.a["purple-1"]};
`,Ge=Object(E.c)(de.h)`
  position: absolute;
  right: 0;
  top: 5px;
`,Ye=Object(E.c)(_e.a)`
  margin-right: 4px;
`,Ke=({timeFormat:e,handleOpen:t,item:a,activeDot:n})=>{var i,r,o,s,d,u,m;if(!a)return null;const b=(null===(i=a.http)||void 0===i?void 0:i.hostname)||a.inner_alert_signature,p=n.type===$e.THREAT&&(null===(o=null===(r=null==n?void 0:n.id)||void 0===r?void 0:r.toString)||void 0===o?void 0:o.call(r))===b;return l.a.createElement(l.a.Fragment,null,p&&l.a.createElement("div",{className:"ignore-body-click"},l.a.createElement(ze,{size:"body",weight:"bold",onClick:()=>t(a,$e.THREAT),className:"ignore-body-click"},l.a.createElement(Ue,{className:"ignore-body-click"},(null===(s=a.http)||void 0===s?void 0:s.hostname)||a.inner_alert_signature||l.a.createElement(h.c,{id:"TM_UNKNOWN"})),l.a.createElement(Ge,{size:"small"}))),l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"TM_SERVICE"})),l.a.createElement(Te.a,null,(null===(d=a.http)||void 0===d?void 0:d.hostname)||a.inner_alert_signature||l.a.createElement(h.c,{id:"COMMON_HYPHEN"}))),l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"TM_DATE_TIME"})),l.a.createElement(Te.a,null,Object(c.format)(a.time,`${me.a}, ${e}`))),l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"COMMON_WORD_IP"})),l.a.createElement(Te.a,null,a.dest_ip)),l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"TM_ACTIVITY"})),l.a.createElement(Te.a,null,Object(q.b)(((null===(u=a.flow)||void 0===u?void 0:u.bytes_toclient)||0)+((null===(m=a.flow)||void 0===m?void 0:m.bytes_toserver)||0)))))},qe=({timeFormat:e,handleOpen:t,item:a,total:n,traffic:i,activeDot:r,openedPpId:o,xValue:s,isLast24H:d})=>{var u,m,b,p;if(!a)return null;const v=r.type===$e.TRAFFIC&&(null===(m=null===(u=null==r?void 0:r.id)||void 0===u?void 0:u.toString)||void 0===m?void 0:m.call(u))===(null==s?void 0:s.toString())||(null==o?void 0:o.toString())===(null==s?void 0:s.toString());return l.a.createElement(l.a.Fragment,null,v&&(null===(b=a.traffic_breakdown)||void 0===b?void 0:b.length)>0?l.a.createElement("div",{className:"ignore-body-click"},l.a.createElement(ze,{size:"body",weight:"bold",onClick:()=>t(a,$e.TRAFFIC,i),className:"ignore-body-click"},l.a.createElement(h.c,{id:"TM_TRAFFIC_ANALYSIS"}),l.a.createElement(Ge,{size:"small"}))):null,l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"TM_TIME"})),l.a.createElement(Te.a,null,Object(c.format)(v&&d&&a.start_timestamp||(null==i?void 0:i.start_timestamp)||a.start_timestamp,e)," ","-"," ",Object(c.format)(v&&d&&a.end_timestamp||(null==i?void 0:i.end_timestamp)||a.end_timestamp,e))),v&&(null==n?void 0:n.identified)>0&&l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"TM_IDENTIFIED_TRAFFIC"})),l.a.createElement(Te.a,null,Object(q.b)((null==n?void 0:n.identified)||0))),l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"COMMON_STATUS_DOWNLOAD"})),l.a.createElement(We,null,Object(q.b)((v?null==n?void 0:n.axisDown:null==n?void 0:n.down)||0))),l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"COMMON_STATUS_UPLOAD"})),l.a.createElement(Te.a,{color:"info"},Object(q.b)((v?null==n?void 0:n.axisUp:null==n?void 0:n.up)||0))),((null==n?void 0:n.clients)>0||(null==i?void 0:i.client_count)>0)&&l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"COMMON_WORD_CLIENTS"})),l.a.createElement(Te.a,null,null!==(p=null==n?void 0:n.clients)&&void 0!==p?p:null==i?void 0:i.client_count)))},Ze=({item:e,handleOpen:t})=>{var a;if(!e)return null;const n=Math.max(...null!==(a=null==e?void 0:e.threats)&&void 0!==a?a:[0])>0;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"ignore-body-click"},l.a.createElement(ze,{size:"body",weight:"bold",onClick:()=>t(e),className:"ignore-body-click"},l.a.createElement(h.c,{id:"TM_DETAILED_VIEW"}),l.a.createElement(Ge,{size:"small"}))),!!e.traffic&&l.a.createElement(l.a.Fragment,null,l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,{weight:"bold"},l.a.createElement(h.c,{id:"TM_TRAFFIC"}))),l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"TM_IDENTIFIED_TRAFFIC"})),l.a.createElement(Te.a,null,Object(q.b)(e.traffic.identified))),l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"COMMON_STATUS_DOWNLOAD"})),l.a.createElement(We,null,Object(q.b)(e.traffic.down))),l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"COMMON_STATUS_UPLOAD"})),l.a.createElement(Te.a,{color:"info"},Object(q.b)(e.traffic.up))),e.traffic.clients&&l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"COMMON_WORD_CLIENTS"})),l.a.createElement(Te.a,null,e.traffic.clients)),e.traffic.events&&l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:"TM_EVENTS"})),l.a.createElement(Te.a,null,e.traffic.events))),n&&l.a.createElement(l.a.Fragment,null,l.a.createElement(Ve,{justifyContent:"space-between"},l.a.createElement(Te.a,{weight:"bold"},l.a.createElement(h.c,{id:"TM_THREATS"}))),e.threats.map((e,t)=>e<1?null:l.a.createElement(Ve,{justifyContent:"space-between",key:t.toString()},l.a.createElement(_.g,{alignItems:"center"},l.a.createElement(Ye,{variant:o.o[t]}),l.a.createElement(Te.a,null,l.a.createElement(h.c,{id:["TM_CONCERNING","TM_CONCERNING","TM_UNKNOWN","TM_KNOWN","TM_BLOCKED"][t]}))),l.a.createElement(Te.a,null,e)))))};var Je=Object(h.f)(({intl:e})=>{var t,a,s;const d=Object(m.n)(),u=Object(n.useRef)(),b=Object(m.q)(u)||window.innerWidth-200,p=Object(r.useSelector)(D.k),g=Object(r.useSelector)(D.l),O=Object(r.useSelector)(v.selectIpsSettings),{endDate:E,startDate:f,preset:h}=Object(r.useSelector)(D.d),j=Object(r.useSelector)(ue.c),_=Object(r.useSelector)(w.L),C=Object(r.useSelector)(D.f),{site:T,dataId:y}=Object(i.m)(),{pathname:S}=Object(i.l)(),x=Object(i.k)(),M=Object(r.useDispatch)(),[k,A]=Object(n.useState)({view:null,type:null,id:null}),L=Object(n.useCallback)(e=>{var t,a,n,l,i,r,c,o;"div"===(null===(a=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.nodeName)||void 0===a?void 0:a.toLowerCase())&&"foreignObject"===(null===(l=null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.parentNode)||void 0===l?void 0:l.nodeName)||(null===(o=null===(c=null===(r=null===(i=null==e?void 0:e.target)||void 0===i?void 0:i.parentNode)||void 0===r?void 0:r.classList)||void 0===c?void 0:c.contains)||void 0===o?void 0:o.call(c,"ignore-body-click"))||k.id&&A({view:null,type:null,id:null})},[k]);Object(n.useEffect)(()=>(document.body.addEventListener("click",L),()=>{document.body.removeEventListener("click",L)}),[L]),Object(n.useEffect)(()=>{(null==k?void 0:k.view)&&k.view!==h&&L()},[h,k.view,L]);const R=h===ge.a["1W"]?Oe.c.WEEK:Oe.c.DAY,F=R!==Oe.c.WEEK,P=Object(n.useMemo)(()=>F&&h!==ge.a["24_HOURS"]?g.client?Object(Oe.f)(g.client,f.getTime()):Object(Oe.i)(f.getTime()):g.client?Object(Oe.g)(g.client,R):Object(Oe.h)(R),[R,F,h,f,g.client]),H=Object(r.useSelector)(P),B=Object(c.addHours)(Object(c.startOfHour)(E),1),$=F?((e,t,a,n)=>{const l=e.getDate()===(new Date).getDate();return Array(25).fill(1).map((t,i)=>{const r=Object(c.subHours)(e,i).getTime(),o=0===i&&l?n.formatMessage({id:"COMMON_GRANUALITY_0"}):Object(c.format)(r,a);return{label:i%2==0?o:null,value:r}}).reverse()})(B,0,_,e):((e,t,a)=>{const n=Object(I.f)(),l=Object(Pe.findTimeZone)(n),i=Object(Pe.findTimeZone)(a),r=new Date(e),o=Object(Pe.getUTCOffset)(r,l),s=Object(Pe.getUTCOffset)(r,i),d=e=>{const t=e+6e4*o.offset-6e4*s.offset;return Object(c.format)(t,"ddd")},u=[];for(let c=e-864e5;c<t+864e5;c+=864e5)u.push({value:c,label:c<e||c>t?null:d(c)});return u})(null===(t=null==H?void 0:H[0])||void 0===t?void 0:t.start_timestamp,null===(a=null==H?void 0:H[H.length-1])||void 0===a?void 0:a.end_timestamp,j),U=g.transferSizeEnabled&&g.transferSizeMin>z.d.transferSizeMin?g.transferSizeMin:0,[V,W]=Object(n.useMemo)(()=>{var e;const t=[],a={};if(F){g.traffic&&H.forEach((e,a)=>{let[n,l]=e.network_usage.reduce(([e,t],{rx_bytes:a,tx_bytes:n})=>[e+(null!=a?a:0),t+(null!=n?n:0)],[0,0]);C&&([n,l]=[l,n]),e.network_usage.forEach((i,r)=>{var o,s,u;if(i.rx_bytes+i.tx_bytes<U)return;const m=new Date(h===ge.a["24_HOURS"]?e.start_timestamp:i.start_timestamp),b=Object(c.startOfHour)(m),p=k.type===$e.TRAFFIC&&(null===(s=null===(o=null==k?void 0:k.id)||void 0===o?void 0:o.toString)||void 0===s?void 0:s.call(o))===(null===(u=b.getTime())||void 0===u?void 0:u.toString());let v=d.motifPalette.uBlue06;(k.id&&(k.type!==$e.TRAFFIC||!p)||!k.id&&y&&y!==b.getTime().toString())&&(v=d.motifPalette.neutral04);const g=h===ge.a["24_HOURS"]?1+new Date(i.start_timestamp).getMinutes()+m.getTime()%(a+r)%4:Be[R][0].value;if(i.rx_bytes+i.tx_bytes===0)return;const O=C?i.tx_bytes:i.rx_bytes,E=C?i.rx_bytes:i.tx_bytes;t.push({id:i.start_timestamp.toString(),x:b.getTime(),y:g,r:He(i.rx_bytes+i.tx_bytes),color:v,item:e,traffic:i,total:{identified:h===ge.a["24_HOURS"]?e.identified_bytes:0,down:O,up:E,clients:i.client_count,axisDown:h===ge.a["24_HOURS"]?n:O,axisUp:h===ge.a["24_HOURS"]?l:E},type:$e.TRAFFIC})})});const a=!k.type&&y,n=a&&p.find(({_id:e})=>a===e),l=k.type?k.type===$e.THREAT&&k.id:(null===(e=null==n?void 0:n.http)||void 0===e?void 0:e.hostname)||(null==n?void 0:n.inner_alert_signature);p.forEach(e=>{var a,n,i;const{inner_alert_severity:r,time:s,flow:u,_id:m}=e,b=(null===(a=e.http)||void 0===a?void 0:a.hostname)||e.inner_alert_signature;let p=O.ips_mode!==v.IpsMode.DISABLED&&d.motifPalette[o.o[r]]||d.motifPalette.neutral04;!k.type&&!y||l&&l===b||(p=d.motifPalette.neutral04),t.push({id:m,x:Object(c.startOfHour)(new Date(s)).getTime(),y:new Date(s).getMinutes(),r:He((null!==(n=null==u?void 0:u.bytes_toclient)&&void 0!==n?n:0)+(null!==(i=null==u?void 0:u.bytes_toserver)&&void 0!==i?i:0)),color:p,item:e,type:$e.THREAT})})}else{if(g.traffic){const e=H.reduce((e,t)=>{var a,n;const l=t.start_timestamp;let i=d.motifPalette.uBlue06;!k.id||k.type===$e.OVERALL&&(null===(n=null===(a=k.id)||void 0===a?void 0:a.toString)||void 0===n?void 0:n.call(a))===l.toString()||(i=d.motifPalette.neutral04),e[l]||(e[l]={id:l+"-daily-dpi",x:l,y:Be[R][0].value,color:i,item:t,total:{identified:0,down:0,up:0},type:$e.TRAFFIC});let[r,c]=t.network_usage.reduce(([e,t],{rx_bytes:a,tx_bytes:n})=>[e+(null!=a?a:0),t+(null!=n?n:0)],[0,0]);return C&&([r,c]=[c,r]),e[l].total.identified+=t.identified_bytes,e[l].total.down+=r,e[l].total.up+=c,e},{});Object.entries(e).forEach(([e,n])=>{a[e]||(a[e]={start_timestamp:Number(e),traffic:{identified:n.total.identified,down:n.total.down,up:n.total.up,clients:n.total.clients},threats:[0,0,0,0,0]}),n.total.down+n.total.up!==0?t.push(n):delete a[e].traffic})}const e=p.reduce((e,t)=>{var n,l,i,r,o,s,d,u;const m=Object(c.startOfDay)(new Date(t.time)).getTime(),b=Object(c.startOfHour)(new Date(t.time)).getTime();return a[m]||(a[m]={start_timestamp:Number(m),threats:[0,0,0,0,0]}),a[m].threats[t.inner_alert_severity]+=1,e[b]?(e[b].r+=(null!==(s=null===(o=t.flow)||void 0===o?void 0:o.bytes_toclient)&&void 0!==s?s:0)+(null!==(u=null===(d=t.flow)||void 0===d?void 0:d.bytes_toserver)&&void 0!==u?u:0),e[b].color=""+Math.min(Number(e[b].color),t.inner_alert_severity),e[b].text=""+((Number(e[b].text)||1)+1)):e[b]={id:b+"-threats",x:m,y:new Date(b).getHours(),r:(null!==(l=null===(n=t.flow)||void 0===n?void 0:n.bytes_toclient)&&void 0!==l?l:0)+(null!==(r=null===(i=t.flow)||void 0===i?void 0:i.bytes_toserver)&&void 0!==r?r:0),color:""+t.inner_alert_severity,type:$e.THREAT,item:t},e},{});Object.values(e).forEach(e=>{var a,n;let l=O.ips_mode!==v.IpsMode.DISABLED&&d.motifPalette[o.o[Number(e.color)]]||d.motifPalette.neutral04;(k.id&&(k.type!==$e.OVERALL||(null===(n=null===(a=k.id)||void 0===a?void 0:a.toString)||void 0===n?void 0:n.call(a))!==e.x.toString())||!k.id&&y&&y!==e.x.toString())&&(l=d.motifPalette.neutral04),t.push({...e,r:Math.max(He(e.r),e.text?8:4),color:l})})}return[t.filter(({x:e})=>{var t,a;return e>=(null===(t=$[1])||void 0===t?void 0:t.value)&&e<(null===(a=$.slice(-1)[0])||void 0===a?void 0:a.value)}),a]},[p,H,F,O.ips_mode,d,null===(s=$[1])||void 0===s?void 0:s.value,y,R,U,g.traffic,k,C]),G=Object(n.useCallback)((e,t,a)=>{var n;let l;if("_id"in e)l=e._id;else{if(!("start_timestamp"in e&&(null===(n=e.traffic_breakdown)||void 0===n?void 0:n.length)&&(null==a?void 0:a.start_timestamp)))return;l=Object(c.startOfHour)(new Date(a.start_timestamp)).getTime()}L();const r=Object(i.i)("/:site/ips/properties/:id/:panel",{id:l,site:T,panel:t===$e.THREAT?je.a.DETAILS:je.a.OVERVIEW});r!==S&&(x.push(r),M(Object(be.g)({type:t===$e.THREAT?pe.b.THREAT_EVENT:pe.b.TRAFFIC_STATS,id:l})))},[M,x,S,T,L]),Y=Object(n.useCallback)(e=>{const t=e["catname"in e?"time":"start_timestamp"],a=new Date(t),n=Object(c.subMilliseconds)(Object(c.addHours)(a,24),1);M(Object(N.d)({startDate:a,endDate:n,preset:null}))},[M]),K=Object(n.useCallback)(({item:e})=>F?null:l.a.createElement(Ze,{item:W[Number(e.x)],handleOpen:Y}),[F,W,Y]),q=Object(n.useMemo)(()=>F?((e,t,a,n,i)=>({item:r})=>{switch(r.type){case $e.THREAT:return l.a.createElement(Ke,{timeFormat:e,item:r.item,handleOpen:t,activeDot:a});case $e.TRAFFIC:return l.a.createElement(qe,{timeFormat:e,item:r.item,traffic:$e.TRAFFIC in r&&r.traffic,total:r.total,handleOpen:t,activeDot:a,openedPpId:n,xValue:r.x,isLast24H:i===ge.a["24_HOURS"]});default:return null}})(_,G,k,y,h):K,[_,G,F,K,k.id,y,h]),Z=Object(n.useCallback)(({item:e})=>{var t,a,n;const l={view:h,type:null,id:null};F?"catname"in e.item?(l.type=$e.THREAT,l.id=(null===(a=null===(t=e.item)||void 0===t?void 0:t.http)||void 0===a?void 0:a.hostname)||(null===(n=e.item)||void 0===n?void 0:n.inner_alert_signature),y&&G(e.item,$e.THREAT)):(l.type=$e.TRAFFIC,l.id=e.x,y&&G(e.item,$e.TRAFFIC,e.traffic)):(l.type=$e.OVERALL,l.id=e.x),!y&&A(l)},[F,G,y,h]);return l.a.createElement("div",{ref:u},l.a.createElement(Re.a,{xAxis:$,yAxis:Be[R],width:b,height:360,margin:[20,50,30,0],yAxisLabelSpacing:b,renderChartElements:e=>l.a.createElement(Fe.a,{data:V,getCoordinates:e,renderTooltipContents:F||k.id?q:void 0,tooltipInteractive:!0,portaledTooltip:!0,tooltipWidth:265,width:b,height:360,onClick:Z})}))});const Xe=Object(E.c)("div")`
  margin-left: ${({theme:e})=>e.spacing["spacing-s"]};
`,Qe=Object(E.c)(de.t)`
  color: ${({theme:e})=>e.motifPalette.success};
`,et=Object(E.c)("div")`
  > div,
  > div > div {
    overflow: visibile !important;
  }

  margin-bottom: 24px;
`,tt=Object(E.c)("div",{shouldForwardProp:e=>"chipChecked"!==e&&"isDark"!==e})`
  > div {
    transform: none !important;
    margin: 0 8px 0 0 !important;
    ${({chipChecked:e,theme:t,isDark:a})=>e?`\n      background: ${t.motifPalette[a?"uBlue10":"uBlue01"]};\n      border-color: ${t.motifPalette[a?"uBlue10":"uBlue01"]};\n\n      &:hover {\n        background: ${t.motifPalette[a?"uBlue09":"uBlue02"]};\n        border-color: ${t.motifPalette[a?"uBlue09":"uBlue02"]};\n      }\n    `:`\n      background: ${t.motifPalette.neutral02};\n      border-color: ${t.motifPalette.neutral02};\n\n      &:hover {\n        background: ${t.motifPalette.neutral03};\n        border-color: ${t.motifPalette.neutral03};\n      }\n    `}
  }
`;var at;!function(e){e.TRAFFIC="traffic",e.THREATS="threats"}(at||(at={}));var nt=()=>{const[e,t]=Object(n.useState)(at.TRAFFIC),a=Object(r.useDispatch)(),o=Object(r.useSelector)(D.k),d=Object(r.useSelector)(D.e),u=Object(r.useSelector)(ue.c),m=Object(r.useSelector)(w.L),{preset:b,startDate:p}=Object(r.useSelector)(D.d),O=Object(r.useSelector)(v.selectIpsSettings),E=Object(r.useSelector)(D.i),f=Object(r.useSelector)(D.l),{site:j}=Object(i.m)(),{pathname:C}=Object(i.l)(),T=Object(i.k)(),y=Object(r.useSelector)(w.u),S=b===ge.a["1W"]?Oe.c.WEEK:Oe.c.DAY,M=S!==Oe.c.WEEK,k=e===at.TRAFFIC,A=!f.threats||f.severity.every(e=>!e),L=Object(n.useMemo)(()=>M&&b!==ge.a["24_HOURS"]?f.client?Object(Oe.f)(f.client,p.getTime()):Object(Oe.i)(p.getTime()):f.client?Object(Oe.g)(f.client,S):Object(Oe.h)(S),[S,M,b,p,f.client]),R=Object(r.useSelector)(L),F=Object(n.useMemo)(()=>{const e=o.slice();return d.forEach(t=>e.push(Object.assign({},t,{isHotneypot:!0}))),e.sort((e,t)=>t.timestamp-e.timestamp)},[o,d]),P=Object(n.useMemo)(()=>{const e=[];return M?b?R.forEach(t=>{var a,n,i,r;const c=null===(a=t.traffic_breakdown)||void 0===a?void 0:a[0];if(!c)return;const[o,s,d]=(null===(n=null==c?void 0:c.usage_by_app)||void 0===n?void 0:n.reduce(([e,t,a],{bytes_received:n,bytes_transmitted:l,packets_received:i,packets_transmitted:r})=>[e+(null!=n?n:0),t+(null!=l?l:0),a+(null!=i?i:0)+(null!=r?r:0)],[0,0,0]))||[0,0,0];o+s!==0&&e.unshift({id:""+t.start_timestamp,dateTime:Object(I.e)(new Date(t.start_timestamp),u,m),service:(null===(i=null==c?void 0:c.usage_by_app)||void 0===i?void 0:i.length)||0,dataUsage:Object(q.b)(o+s),packets:Object(re.a)(d,{spacer:" "}),down:Object(q.b)(o),up:Object(q.b)(s),start_timestamp:t.start_timestamp,children:null===(r=null==c?void 0:c.usage_by_app)||void 0===r?void 0:r.map(e=>{const t=Object(fe.getCompoundId)({cat:e.category,app:e.application}),{name:a,iconFileName:n}=Ee.dpiApps[t]||{name:null,iconFileName:null};return{id:`child-${c.start_timestamp}-${e.application}-${e.category}`,dateTime:" ",service:l.a.createElement(_.g,{alignItems:"center"},l.a.createElement(he.a,{name:a,iconFileName:n}),a||l.a.createElement(h.c,{id:"COMMON_UNKNOWN"})),dataUsage:Object(q.b)(e.bytes_received+e.bytes_transmitted),packets:Object(re.a)(e.packets_received+e.packets_transmitted,{spacer:" "}),down:Object(q.b)(e.bytes_received),up:Object(q.b)(e.bytes_transmitted),start_timestamp:c.start_timestamp}})})}):R.forEach(t=>{t.traffic_breakdown.forEach(t=>{var a,n;const[i,r,c]=(null===(a=t.usage_by_app)||void 0===a?void 0:a.reduce(([e,t,a],{bytes_received:n,bytes_transmitted:l,packets_received:i,packets_transmitted:r})=>[e+(null!=n?n:0),t+(null!=l?l:0),a+(null!=i?i:0)+(null!=r?r:0)],[0,0,0]))||[0,0,0];i+r!==0&&e.unshift({id:""+t.start_timestamp,dateTime:Object(I.e)(new Date(t.start_timestamp),u,m),service:(null===(n=null==t?void 0:t.usage_by_app)||void 0===n?void 0:n.length)||0,dataUsage:Object(q.b)(i+r),packets:Object(re.a)(c,{spacer:" "}),down:Object(q.b)(i),up:Object(q.b)(r),start_timestamp:t.start_timestamp,children:t.usage_by_app.map(e=>{const a=Object(fe.getCompoundId)({cat:e.category,app:e.application}),{name:n,iconFileName:i}=Ee.dpiApps[a]||{name:null,iconFileName:null};return{id:`child-${t.start_timestamp}-${e.application}-${e.category}`,dateTime:" ",service:l.a.createElement(_.g,{alignItems:"center"},l.a.createElement(he.a,{name:n,iconFileName:i}),n||l.a.createElement(h.c,{id:"COMMON_UNKNOWN"})),dataUsage:Object(q.b)(e.bytes_received+e.bytes_transmitted),packets:Object(re.a)(e.packets_received+e.packets_transmitted,{spacer:" "}),down:Object(q.b)(e.bytes_received),up:Object(q.b)(e.bytes_transmitted),start_timestamp:t.start_timestamp}})})})}):R.forEach(t=>{var a,n;if(!(null===(a=t.traffic_breakdown)||void 0===a?void 0:a.length))return;const[l,i,r,c]=(null===(n=t.traffic_breakdown.flatMap(({usage_by_app:e})=>e))||void 0===n?void 0:n.reduce(([e,t,a,n],{bytes_received:l,bytes_transmitted:i,packets_received:r,packets_transmitted:c,category:o,application:s})=>(n[Object(fe.getCompoundId)({cat:o,app:s})]=1,[e+(null!=l?l:0),t+(null!=i?i:0),a+(null!=r?r:0)+(null!=c?c:0),n]),[0,0,0,{}]))||[0,0,0,{}],o=t.traffic_breakdown.reduce((e,t)=>{var a;const[n,l,i,r]=t.usage_by_app.reduce(([e,t,a,n],{bytes_received:l,bytes_transmitted:i,packets_received:r,packets_transmitted:c,category:o,application:s})=>(n[Object(fe.getCompoundId)({cat:o,app:s})]=1,[e+(null!=l?l:0),t+(null!=i?i:0),a+(null!=r?r:0)+(null!=c?c:0),n]),[0,0,0,{}])||[0,0,0,{}];return n+l===0||e.push({id:"child-"+t.start_timestamp,dateTime:Object(I.e)(new Date(t.start_timestamp),u,m),service:null!==(a=Object.keys(r).length)&&void 0!==a?a:0,dataUsage:Object(q.b)(n+l),packets:Object(re.a)(i,{spacer:" "}),down:Object(q.b)(n),up:Object(q.b)(l),start_timestamp:t.start_timestamp}),e},[]).reverse();0!==o.length&&e.unshift({id:""+t.start_timestamp,dateTime:Object(I.e)(new Date(t.start_timestamp),u,me.a),service:Object.keys(c).length||0,dataUsage:Object(q.b)(l+i),packets:Object(re.a)(r,{spacer:" "}),down:Object(q.b)(l),up:Object(q.b)(i),start_timestamp:t.start_timestamp,children:o})}),e},[R,u,m,M,b]),H=e===at.THREATS?F:P;Object(n.useEffect)(()=>{const e=Math.ceil((Date.now()-new Date(p).getTime())/36e5);a(Object(s.fetchOfflineClients)({queryParams:{withinHours:e}},{crudCacheStrategy:{type:g.a.CACHE}}))},[a,p]);const B=Object(n.useCallback)(e=>{const t=Object(c.startOfHour)(new Date(e.start_timestamp)).getTime(),n=Object(i.i)("/:site/ips/properties/:id",{id:t,site:j});n!==C&&(T.push(n),a(Object(be.g)({type:pe.b.TRAFFIC_STATS,id:t})))},[a,T,C,j]),$=Object(n.useCallback)(e=>{const t=Object(i.i)("/:site/ips/properties/:id/:panel",{id:e._id,site:j,panel:"honeypot"===e.type?je.a.OVERVIEW:je.a.DETAILS});t!==C&&(T.push(t),a(Object(be.g)({type:"honeypot"===e.type?pe.b.HONEYPOT_ALERT:pe.b.THREAT_EVENT,id:e._id})))},[a,T,C,j]),U=Object(n.useCallback)(()=>{a(Object(Y.a)({title:"TM_ENABLE_IDS",message:"TM_ENABLE_IDS_DESC",confirmButtonProps:{text:l.a.createElement(h.c,{id:"COMMON_ACTION_ENABLE"})},onConfirm:()=>{a(Object(v.saveSettings)({...O,ips_mode:v.IpsMode.IPS})),a(Object(K.e)())},onCancel:()=>{a(Object(K.e)())}}))},[a,O]),V=Object(n.useCallback)(({from:e,rowsPerPage:t})=>l.a.createElement(_.g,{overflow:"auto",marginTop:8},k?l.a.createElement(ce.a,{items:P,idField:"id",columns:z.g,rowHeight:48,onRowClick:B,disableColumnFilters:!0}):l.a.createElement(ce.a,{items:F,rowLimit:t,rowOffset:e,idField:"_id",columns:Object(z.c)(u,me.a,m),rowHeight:48,onRowClick:$,disableColumnFilters:!0})),[k,F,P,u,m,$,B]);return l.a.createElement(_.g,{flexDirection:"column",height:"100%",paddingBottom:32,overflow:"auto"},l.a.createElement(_.g,{flexDirection:"column",padding:"38px 32px 0"},l.a.createElement(De,null),l.a.createElement(Je,null)),l.a.createElement(_.g,{marginTop:24,padding:"0 32px"},l.a.createElement(tt,{chipChecked:k,isDark:y},l.a.createElement(oe.a,{width:"auto",onClick:()=>t(at.TRAFFIC),label:`Traffic (${P.length})`})),l.a.createElement(tt,{chipChecked:!k,isDark:y},l.a.createElement(oe.a,{width:"auto",onClick:()=>t(at.THREATS),label:`Threats (${F.length})`}))),l.a.createElement(et,null,(null==H?void 0:H.length)?l.a.createElement(ve.a,{section:"TM_EVENTS",items:H,tableType:k?x.a.THREAT_MANAGEMENT_EVENT_TIMELINE_TRAFFIC:x.a.THREAT_MANAGEMENT_EVENT_TIMELINE,onRenderTable:V,onPageChanged:k?void 0:e=>a(Object(N.e)(e)),pageNumber:k?1:E}):k?l.a.createElement(_.g,{alignItems:"center",marginTop:"24px",marginLeft:"32px"},l.a.createElement("div",null,l.a.createElement(de.ab,{isActive:!0})),l.a.createElement(Xe,null,l.a.createElement(h.c,{id:"TM_NO_DPI_DATA"}))):O.ips_mode===v.IpsMode.DISABLED||A?l.a.createElement(_.g,{alignItems:"center",marginTop:"24px",marginLeft:"32px"},l.a.createElement("div",null,l.a.createElement(de.ab,{isActive:!0})),l.a.createElement(Xe,null,!A&&l.a.createElement(l.a.Fragment,null,l.a.createElement(h.c,{id:"COMMON_ACTION_ENABLE"})," ",l.a.createElement(se.a,{variant:"inline",onClick:U},l.a.createElement(h.c,{id:"TM_IDS"}))," "),l.a.createElement(h.c,{id:A?"TM_NO_THREATS_DISPLAYED":"TM_FOR_FULL_ANALYSIS"}))):l.a.createElement(_.g,{alignItems:"center",marginTop:"24px",marginLeft:"32px"},l.a.createElement("div",null,l.a.createElement(Qe,{variant:"twoTone"})),l.a.createElement(Xe,null,l.a.createElement(h.c,{id:"TM_NO_THREATS"})))))},lt=a(1801),it=a(2880),rt=a(2720),ct=a(1275);const ot=["#000","#F6898B","#f9ca7a","#e5e7ed","#89e0a2"],st=(e,t)=>["case",["==",["get","severity"],4],e?t.motifPalette[o.o[4]]:ot[4],["==",["get","severity"],3],e?t.motifPalette.ui03:ot[3],["==",["get","severity"],2],e?t.motifPalette[o.o[2]]:ot[2],e?t.motifPalette[o.o[1]]:ot[1]],dt=[4,1e3,5,1e4,6,1e5,7,5e5,8,1e6,9,2e6,10,3e6,11,5e6,12,7e6,13,8e6,14,1e7,15,3e7,16,5e7,17,7e7,18,9e7,19,1e8,20,3e8,21,5e8,22,8e8,23,1e9,24],ut=Object(E.c)("div")`
  position: absolute;
  top: 38px;
  left: 32px;
  right: 32px;
  z-index: 10;
`;const mt=(e,t)=>(a,n,l)=>{n&&e.forEach(e=>{const i={id:n,source:e,sourceLayer:ct.c.POLYGON_SOURCE_LAYER};a.setFeatureState(i,{[t]:l})})},bt=mt([ct.e.clickFills,ct.e.clickOutlines],"clicked"),pt=mt([ct.e.blockFills,ct.e.blockOutlines],"blocked");var vt=({apiKey:e,blockedCountries:t,geoIpDisabled:a,width:i,height:c,isUdm:o,setClickedCountry:s})=>{const d=Object(n.useRef)(null),[u,b]=Object(n.useState)(),[p,v]=Object(n.useState)(((e,t)=>({width:e,height:t,latitude:37.79135735681293,longitude:-28.29720149912995,pitch:0,bearing:0,zoom:2}))(i,c)),[g,O]=Object(n.useState)(),[E,f]=Object(n.useState)(!1),h=Object(r.useSelector)(D.g),j=Object(m.n)(),_=Object(r.useSelector)(D.k),C=Object(r.useSelector)(D.l),T=C.transferSizeEnabled&&C.transferSizeMin>z.d.transferSizeMin,y=Object(n.useMemo)(()=>({type:"FeatureCollection",features:_.filter(({dstipGeo:e,usgipGeo:t})=>(null==e?void 0:e.longitude)&&e.latitude||(null==t?void 0:t.longitude)&&t.latitude).map(e=>{var t,a,n,l,i,r,c;const o=(null!==(a=null===(t=null==e?void 0:e.flow)||void 0===t?void 0:t.bytes_toclient)&&void 0!==a?a:0)+(null===(n=null==e?void 0:e.flow)||void 0===n?void 0:n.bytes_toserver),s=e.inner_alert_severity;return{type:"Feature",properties:{id:e._id,activity:o,severity:s,color:j.motifPalette[s]},geometry:{type:"Point",coordinates:[(null===(l=e.dstipGeo)||void 0===l?void 0:l.longitude)||(null===(i=e.usgipGeo)||void 0===i?void 0:i.longitude),(null===(r=e.dstipGeo)||void 0===r?void 0:r.latitude)||(null===(c=e.usgipGeo)||void 0===c?void 0:c.latitude)]},clusterProperties:{severity:["min",["get","severity"]],activity:["+",["get","activity"]]}}})}),[_,j]),S=Object(n.useMemo)(()=>({id:"clusters",type:"circle",source:"events",filter:["has","point_count"],paint:{"circle-color":st(T,j),"circle-stroke-width":1,"circle-stroke-color":st(T,j),"circle-radius":T?["step",["get","activity"],...dt]:["step",["get","point_count"],12,9,14,20,15,30,16,40,17,50,18,80,20,100,22,150,23,300,24,500,25,750,26,1e3,27,2e3,28]}}),[T,j]),w=Object(n.useMemo)(()=>({id:"cluster-count",type:"symbol",source:"events",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-size":T?0:12}}),[T]),x=Object(n.useMemo)(()=>({id:"unclustered-point",type:"circle",source:"events",filter:["!",["has","point_count"]],paint:{"circle-color":st(T,j),"circle-radius":["step",["get","activity"],...dt],"circle-stroke-width":1,"circle-stroke-color":st(T,j)}}),[T,j]);Object(n.useEffect)(()=>{var e;if(!E)return;const t=null===(e=d.current)||void 0===e?void 0:e.getMap();["clusters","cluster-count","unclustered-point"].forEach(e=>{t.getLayer(e)&&t.removeLayer(e)}),t.getSource("events")&&t.removeSource("events"),t.addSource("events",{type:"geojson",cluster:!0,clusterRadius:30,data:y}).addLayer(S).addLayer(w).addLayer(x)},[y,S,w,x,E]);const M=Object(n.useCallback)(()=>{var e;bt(null===(e=d.current)||void 0===e?void 0:e.getMap(),u,!1),b(void 0)},[u]),k=Object(n.useCallback)(e=>{var t,a,n,l,i,r;if(!E)return;const c=null===(t=d.current)||void 0===t?void 0:t.getMap().queryRenderedFeatures([e.x,e.y]);if(c.length){const e=null===(a=null==c?void 0:c.find)||void 0===a?void 0:a.call(c,e=>e.source===ct.e.clickFills),t=null===(n=null==c?void 0:c.find)||void 0===n?void 0:n.call(c,e=>"events"===e.source);if(t){d.current.getMap().getSource("events").getClusterExpansionZoom(t.id,(e,a)=>{e||v({...p,longitude:t.geometry.coordinates[0],latitude:t.geometry.coordinates[1],zoom:Math.min(a||12,15),transitionDuration:300})})}else if(e){const t=null===(l=null==e?void 0:e.properties)||void 0===l?void 0:l.NAME,a=(o=e,m=t,ct.d[m]?ct.d[m]:o.properties.ISO_A2),n=e.id;u&&u===n||bt(null===(i=d.current)||void 0===i?void 0:i.getMap(),n,!0),u!==n&&bt(null===(r=d.current)||void 0===r?void 0:r.getMap(),u,!1),b(n),s(a)}else M(),s("")}var o,m},[u,M,p,s,E]),A=Object(n.useCallback)(({viewState:e})=>{v(e)},[]),I=Object(n.useCallback)(({x:e,y:t})=>{var a;const n=null===(a=d.current)||void 0===a?void 0:a.getMap();if(!(e&&t&&n&&E))return;const[l]=n.queryRenderedFeatures([e,t],{layers:[ct.e.clickFills]}),i=l&&l.id;i&&i!==g?(bt(n,i,!0),bt(n,g,!1),O(i)):!i&&g&&(bt(n,g,!1),O(void 0))},[g,E]),N=Object(n.useCallback)(()=>{var e,t,a;const n=null===(e=d.current)||void 0===e?void 0:e.getMap(),{layers:l}=n.getStyle(),i=null===(a=null===(t=l.filter(e=>"symbol"===e.type))||void 0===t?void 0:t[0])||void 0===a?void 0:a.id;Object.entries(ct.b).forEach(([e,t])=>n.addSource(e,t)),ct.a.forEach(e=>n.addLayer(e,i))},[]),L=Object(n.useCallback)((e,t)=>{var a;return pt(null===(a=d.current)||void 0===a?void 0:a.getMap(),e,t)},[]),R=Object(n.useCallback)((e,t)=>{var a;null===(a=d.current)||void 0===a||a.getMap().queryRenderedFeatures(void 0,{layers:[ct.e.blockFills]}).filter(t=>e.includes(t.properties.ISO_A2)).forEach(e=>L(e.id,t))},[L]),F=Object(n.useCallback)(()=>{a||R(t,!0)},[a,t,R]),P=Object(n.useCallback)(()=>{var e;const t=null===(e=d.current)||void 0===e?void 0:e.getMap();N(),t.once("idle",()=>{F(),f(!0)})},[N,F]),H=Object(n.useCallback)(()=>g?"pointer":"grab",[g]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(l.a.Fragment,null,l.a.createElement(ut,null,l.a.createElement(De,{isMap:!0}))),l.a.createElement(it.a,{controller:!0,onClick:k,viewState:p,onHover:I,getCursor:H,maxZoom:15,onViewStateChange:A},l.a.createElement(rt.a,{onLoad:P,ref:d,attributionControl:!1,mapboxApiAccessToken:e,mapStyle:h,minZoom:2,maxZoom:15})))};const gt=Object(E.c)("div")`
  margin-bottom: 24px;
  position: relative;
  height: 100%;
  display: flex;
  flex: 1;
  width: 100%;
`;var Ot=({setClickedCountry:e})=>{const t=Object(n.useRef)(),a=Object(m.q)(t)||window.innerWidth-50,i=Object(m.e)(t)||window.innerHeight-102,c=Object(r.useSelector)(p.c),o=Object(r.useSelector)(M.m),s=(d=Object(r.useSelector)(v.selectUsgSettings),null!==(O=null===(b=null===(u=null==d?void 0:d.geo_ip_filtering_countries)||void 0===u?void 0:u.split)||void 0===b?void 0:b.call(u,","))&&void 0!==O?O:[]);var d,u,b,O;const E=Object(r.useSelector)(lt.a);return Object(m.g)([Object(p.a)(void 0,{type:g.a.CACHE})],l.a.createElement(gt,{innerRef:t},l.a.createElement(vt,{apiKey:c,geoIpDisabled:!o&&!E,isUdm:o,blockedCountries:s,width:a,height:i,setClickedCountry:e})))},Et=a(366);const ft=Object(E.c)("div")`
  position: absolute;
  bottom: 0;
  right: 0;
  left: 0;
  max-height: 310px;
  z-index: 10;
  background: ${({theme:e})=>e.motifPalette.ui01};
`,ht=Object(E.c)("div")`
  padding-bottom: 20px;
  overflow-x: auto;
  overflow-y: visible;
  max-height: 310px;
`,jt=Object(E.c)(_.g)`
  position: absolute;
  height: 40px;
  width: 40px;
  right: 0;
  top: 3px;
  cursor: pointer;
  z-index: 10;
`;var _t=({country:e,setCountry:t})=>{var a,c;const o=Object(r.useDispatch)(),d=Object(r.useSelector)(D.k),u=Object(r.useSelector)(ue.c),m=Object(r.useSelector)(w.N),{preferences:{timeFormat:b}}=Object(r.useSelector)(w.P),p=Object(r.useSelector)(D.d),v=Object(Et.a)(b,m),{site:O}=Object(i.m)(),{pathname:E}=Object(i.l)(),f=Object(i.k)(),h=Object(n.useCallback)(e=>{if(e.parent)return;const t=Object(i.i)("/:site/ips/map/properties/:id/details",{id:e._id,site:O});t!==E&&(f.push(t),o(Object(be.g)({type:pe.b.THREAT_EVENT,id:e._id})))},[o,f,E,O]);Object(n.useEffect)(()=>{const e=Math.ceil((Date.now()-new Date(p.startDate).getTime())/36e5);o(Object(s.fetchOfflineClients)({queryParams:{withinHours:e}},{crudCacheStrategy:{type:g.a.CACHE}}))},[o,p.startDate]);const j=Object(n.useMemo)(()=>{var t,a;const n=d.filter(t=>{var a,n;return((null===(a=null==t?void 0:t.dstipGeo)||void 0===a?void 0:a.country_code)||(null===(n=null==t?void 0:t.usgipGeo)||void 0===n?void 0:n.country_code))===e}),l={country_name:"-",...null===(t=n[0])||void 0===t?void 0:t.usgipGeo,...null===(a=n[0])||void 0===a?void 0:a.dstipGeo},i=new Set(n.map(({http:e,inner_alert_signature:t})=>(null==e?void 0:e.hostname)||t||"-")).size,r=new Set(n.map(({catname:e})=>e||"-")).size,c=n.reduce((e,{flow:t})=>{var a,n;return e+(null!==(a=null==t?void 0:t.bytes_toclient)&&void 0!==a?a:0)+(null!==(n=null==t?void 0:t.bytes_toserver)&&void 0!==n?n:0)},0);return[{parent:!0,_id:"table-for-"+l.country_name,children:n,dstipGeo:l,totalServices:i,totalCategories:r,totalActivity:c}]},[d,e]),_=null===(c=null===(a=j[0])||void 0===a?void 0:a.children)||void 0===c?void 0:c.length,C=Object(n.useCallback)(()=>t(""),[t]);return Object(n.useEffect)(()=>{_||C()},[_,C]),_?l.a.createElement(ft,null,l.a.createElement(jt,{justifyContent:"center",alignItems:"center",onClick:C},l.a.createElement(de.A,null)),l.a.createElement(ht,null,l.a.createElement(ce.a,{items:j,idField:"_id",columns:Object(z.b)(u,me.a,v),rowHeight:48,onRowClick:h,disableColumnFilters:!0}))):null};var Ct=()=>{const[e,t]=Object(n.useState)("");return l.a.createElement(l.a.Fragment,null,l.a.createElement(_.g,{height:"100%",width:"100%"},l.a.createElement(Ot,{setClickedCountry:t})),!!e&&l.a.createElement(_t,{country:e,setCountry:t}))};t.default=()=>{const e=Object(r.useDispatch)(),t=Object(r.useSelector)(D.l),{preset:a,startDate:E}=Object(r.useSelector)(D.d);return Object(n.useEffect)(()=>{e(Object(D.a)())},[e,a,E,t.client]),Object(n.useEffect)(()=>{e(Object(o.e)(void 0,{crudCacheStrategy:{type:g.a.CACHE}})),e(Object(p.a)(void 0,{type:g.a.CACHE})),e(Object(s.fetchClients)(void 0,{crudCacheStrategy:{type:g.a.CACHE}})),e(Object(s.fetchOfflineClients)({queryParams:{withinHours:168}},{crudCacheStrategy:{type:g.a.CACHE}})),e(Object(s.fetchBlockedClients)(void 0,{crudCacheStrategy:{type:g.a.CACHE}}));const t=new Date;e(Object(o.d)(Object(c.startOfDay)(Object(c.subDays)(t,7)),t,{crudCacheStrategy:{type:g.a.CACHE}}))},[e]),Object(m.g)([Object(d.c)("threatManagement"),Object(d.c)("pagination"),Object(v.fetchSettings)({type:g.a.CACHE})],l.a.createElement(i.d,{path:["/:site/ips/properties/:dataId?","/:site/ips/:threatPage?","/:site/ips/:threatPage?/properties/:dataId?"]},l.a.createElement(u.a,null,l.a.createElement(ie,null),l.a.createElement(i.g,null,l.a.createElement(b.a,{path:"/:site/ips/"+z.e[U.a.MAP],component:Ct}),l.a.createElement(b.a,{component:nt})),l.a.createElement(b.a,{path:["/:site/ips/properties/:id","/:site/ips/:threatPage/properties/:id"]},l.a.createElement(O.a,null)))),{trackingName:"threat-management"})}}}]);
//# sourceMappingURL=threatManagement.f400b1db6c26e1693504.js.map